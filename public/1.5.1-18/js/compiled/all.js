function EventEmitter(){var a={},b=this;b.Event=function(a,c,d,e){var f=this;f.type=a,f.listener=c,f.once=e,f.fire=function(e){c.apply(d||f,e||[]);if(f.once)return b.removeListener(a,c),!1}},b.eachListener=function(c,d){var e=null,f=null;if(a.hasOwnProperty(c)){f=a[c];for(e=0;e<f.length;e+=1)d.call(b,f[e],e)===!1&&(e-=1)}},b.addListener=function(c,d,e,f){return a.hasOwnProperty(c)||(a[c]=[]),a[c].push(new b.Event(c,d,e,f)),b.emit("newListener",c,d,e,f),b},b.on=b.addListener,b.once=function(a,c,d){return b.addListener(a,c,d,!0)},b.removeListener=function(c,d){return b.eachListener(c,function(b,e){b.listener===d&&a[c].splice(e,1)}),a[c]&&a[c].length===0&&delete a[c],b},b.removeAllListeners=function(c){return a.hasOwnProperty(c)&&delete a[c],b},b.listeners=function(b){return a.hasOwnProperty(b)?a[b]:!1},b.emit=function(a,c){return b.eachListener(a,function(a){return a.fire(c)}),b}}!function(a,b){typeof define=="function"?define("vendor/ender/reqwest",[],b):typeof module!="undefined"?module.exports=b():this[a]=b()}("reqwest",function(){function handleReadyState(a,b,c){return function(){a&&a[readyState]==4&&(twoHundo.test(a.status)?b(a):c(a))}}function setHeaders(a,b){var c=b.headers||{};c.Accept=c.Accept||defaultHeaders.accept[b.type]||defaultHeaders.accept["*"],!b.crossOrigin&&!c[requestedWith]&&(c[requestedWith]=defaultHeaders.requestedWith),c[contentType]||(c[contentType]=b.contentType||defaultHeaders.contentType);for(var d in c)c.hasOwnProperty(d)&&a.setRequestHeader(d,c[d])}function generalCallback(a){lastValue=a}function urlappend(a,b){return a+(/\?/.test(a)?"&":"?")+b}function handleJsonp(a,b,c,d){var e=uniqid++,f=a.jsonpCallback||"callback",g=a.jsonpCallbackName||"reqwest_"+e,h=new RegExp("((^|\\?|&)"+f+")=([^&]+)"),i=d.match(h),j=doc.createElement("script"),k=0,l=0,m=this;return i?i[3]==="?"?d=d.replace(h,"$1="+g):g=i[3]:d=urlappend(d,f+"="+g),win[g]=generalCallback,j.src=d,j.async=!0,typeof j.onreadystatechange!="undefined"&&(j.event="onclick",j.htmlFor=j.id="_reqwest_"+e),j.onload=j.onreadystatechange=function(){if(j[readyState]&&j[readyState]!=="complete"&&j[readyState]!=="loaded"||k)return!1;j.onload=j.onreadystatechange=null,j.onclick&&j.onclick(),a.timeout&&clearTimeout(m.timeout),!l&&a.success&&a.success(lastValue),lastValue=undefined,head.removeChild(j),k=1},head.appendChild(j),{abort:function(){l=1,c&c()}}}function getRequest(a,b,c){var d=(a.method||"GET").toUpperCase(),e=typeof a=="string"?a:a.url,f=a.processData!==!1&&a.data&&typeof a.data!="string"?reqwest.toQueryString(a.data):a.data||null;(a.type=="jsonp"||d=="GET")&&f&&(e=urlappend(e,f))&&(f=null);if(a.type=="jsonp")return handleJsonp.call(this,a,b,c,e);var g=xhr();return g.open(d,e,!0),setHeaders(g,a),g.onreadystatechange=handleReadyState(g,b,c),a.before&&a.before(g),g.send(f),g}function Reqwest(a,b){this.o=a,this.fn=b,init.apply(this,arguments)}function setType(a){var b=a.match(/\.(json|jsonp|html|xml)(\?|$)/);return b?b[1]:"js"}function init(o,fn){function complete(a){o.timeout&&clearTimeout(self.timeout),self.timeout=null,o.complete&&o.complete(a)}function success(resp){var r=resp.responseText;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r}fn(resp),o.success&&o.success(resp),complete(resp)}function error(a,b,c){o.error&&o.error(a,b,c),complete(a)}this.url=typeof o=="string"?o:o.url,this.timeout=null;var type=o.type||setType(this.url),self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),this.request=getRequest.call(this,o,success,error)}function reqwest(a,b){return new Reqwest(a,b)}function normalize(a){return a?a.replace(/\r?\n/g,"\r\n"):""}function serial(a,b){var c=a.name,d=a.tagName.toLowerCase(),e=function(a){a&&!a.disabled&&b(c,normalize(a.attributes.value&&a.attributes.value.specified?a.value:a.text))};if(a.disabled||!c)return;switch(d){case"input":if(!/reset|button|image|file/i.test(a.type)){var f=/checkbox/i.test(a.type),g=/radio/i.test(a.type),h=a.value;(!f&&!g||a.checked)&&b(c,normalize(f&&h===""?"on":h))}break;case"textarea":b(c,normalize(a.value));break;case"select":if(a.type.toLowerCase()==="select-one")e(a.selectedIndex>=0?a.options[a.selectedIndex]:null);else for(var i=0;a.length&&i<a.length;i++)a.options[i].selected&&e(a.options[i])}}function eachFormElement(){var a=this,b,c,d,e=function(b,c){for(var e=0;e<c.length;e++){var f=b[byTag](c[e]);for(d=0;d<f.length;d++)serial(f[d],a)}};for(c=0;c<arguments.length;c++)b=arguments[c],/input|select|textarea/i.test(b.tagName)&&serial(b,a),e(b,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var a={};return eachFormElement.apply(function(b,c){b in a?(a[b]&&!isArray(a[b])&&(a[b]=[a[b]]),a[b].push(c)):a[b]=c},arguments),a}var context=this,win=window,doc=document,old=context.reqwest,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,lastValue,xmlHttpRequest="XMLHttpRequest",defaultHeaders={contentType:"application/x-www-form-urlencoded",accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"},requestedWith:xmlHttpRequest},xhr=xmlHttpRequest in win?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};Reqwest.prototype={abort:function(){this.request.abort()},retry:function(){init.call(this,this.o,this.fn)}};var isArray=typeof Array.isArray=="function"?Array.isArray:function(a){return a instanceof Array};return reqwest.serializeArray=function(){var a=[];return eachFormElement.apply(function(b,c){a.push({name:b,value:c})},arguments),a},reqwest.serialize=function(){if(arguments.length===0)return"";var a,b,c=Array.prototype.slice.call(arguments,0);return a=c.pop(),a&&a.nodeType&&c.push(a)&&(a=null),a&&(a=a.type),a=="map"?b=serializeHash:a=="array"?b=reqwest.serializeArray:b=serializeQueryString,b.apply(null,c)},reqwest.toQueryString=function(a){var b="",c,d=encodeURIComponent,e=function(a,c){b+=d(a)+"="+d(c)+"&"};if(isArray(a))for(c=0;a&&c<a.length;c++)e(a[c].name,a[c].value);else for(var f in a){if(!Object.hasOwnProperty.call(a,f))continue;var g=a[f];if(isArray(g))for(c=0;c<g.length;c++)e(f,g[c]);else e(f,a[f])}return b.replace(/&$/,"").replace(/%20/g,"+")},reqwest.compat=function(a,b){return a&&(a.type&&(a.method=a.type)&&delete a.type,a.dataType&&(a.type=a.dataType),a.jsonpCallback&&(a.jsonpCallbackName=a.jsonpCallback)&&delete a.jsonpCallback,a.jsonp&&(a.jsonpCallback=a.jsonp)),new Reqwest(a,b)},reqwest.noConflict=function(){return context.reqwest=old,this},reqwest}),define("module/translations/russian",{singularHoursAgo:"{x} час назад",genSingularHoursAgo:"{x} часа назад",genPluralHoursAgo:"{x} часов назад",singularMinutesAgo:"{x} минута назад",genSingularMinutesAgo:"{x} минуты назад",genPluralMinutesAgo:"{x} минут назад",lessThanAMinuteAgo:"Меньше минуты назад",changeYourLocation:"Изменить местонахождение",enterTownPostcode:"Введите город или почтовый индекс",loading:"Загрузка",localNewsAndWeather:"Местные новости и погода",localNewsCouldNotBeLoaded:"Местные новости не загружаются",pleaseWait:"Подождите, пожалуйста",retry:"Повторить",search:"Поиск",sendAnotherComment:"Отправить другой комментарий",showMore:"Показать ещё",locationSettingNotAvailable:"К сожалению, локализация здесь недоступна",useMyLocationNotAvailable:'К сожалению, опция "использовать локализацию" сейчас недоступна',anErrorHasOccured:"К сожалению, произошла ошибка. Попробуйте ещё раз",locationSettingIsNotCurrentlyAvailable:"К сожалению, установки локализации сейчас недоступны",errorTryingToDetectLocation:"Произошла ошибка в процессе локализации. Попробуйте ещё раз",searchResults:"Результаты поиска:",searchTerm:"Поисковый запрос",section:"Разделы",noResults:"Результат отсутствует",thereWasAProblem:"Произошла ошибка; попробуйте ещё раз",unableToDetectLocation:"Не удаётся установить местонахождение",useMyLocation:"Использовать локализацию",locationBetweenCountries:"Выбранное Вами место находится между двумя странами [или административными/географическими единицами]. Чтобы установить своё местонахождение, пожалуйста, выберите ближайшую к Вам страну."}),typeof exports!="undefined"&&(exports.EventEmitter=EventEmitter),define("vendor/events/eventEmitter",[],function(){return{}}),!function(a,b){typeof define=="function"?define("vendor/ender/bonzo",[],b):typeof module!="undefined"?module.exports=b():this[a]=b()}("bonzo",function(){function w(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function x(a,b,c){for(var d=0,e=a.length;d<e;d++)b.call(c||a[d],a[d],d,a);return a}function y(a){return a.replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function z(a){return a&&a.nodeName&&a.nodeType==1}function A(a,b,c,d){var e;for(d=0,e=a.length;d<e;++d)if(b.call(c,a[d],d,a))return!0;return!1}function C(a,b,c){var d=0,g=b||this,h=[],i=f&&typeof a=="string"&&a.charAt(0)!="<"?f(a):a;return x(I(i),function(a){x(g,function(b){var f=!b[e]||b[e]&&!b[e][e]?function(){var a=b.cloneNode(!0);return g.$&&g.cloneEvents&&g.$(a).cloneEvents(b),a}():b;c(a,f),h[d]=f,d++})},this),x(h,function(a,b){g[b]=a}),g.length=d,g}function D(a,b,c){var d=M(a),e=d.css("position"),f=d.offset(),g="relative",h=e==g,i=[parseInt(d.css("left"),10),parseInt(d.css("top"),10)];e=="static"&&(d.css("position",g),e=g),isNaN(i[0])&&(i[0]=h?0:a.offsetLeft),isNaN(i[1])&&(i[1]=h?0:a.offsetTop),b!=null&&(a.style.left=b-f.left+i[0]+p),c!=null&&(a.style.top=c-f.top+i[1]+p)}function E(a,b){return w(b).test(a.className)}function F(a,b){a.className=v(a.className+" "+b)}function G(a,b){a.className=v(a.className.replace(w(b)," "))}function H(a){this.length=0;if(a){a=typeof a!="string"&&!a.nodeType&&typeof a.length!="undefined"?a:[a],this.length=a.length;for(var b=0;b<a.length;b++)this[b]=a[b]}}function I(a){return typeof a=="string"?M.create(a):z(a)?[a]:a}function J(a,c,d){var e=this[0];return a==null&&c==null?(K(e)?L():{x:e.scrollLeft,y:e.scrollTop})[d]:(K(e)?b.scrollTo(a,c):(a!=null&&(e.scrollLeft=a),c!=null&&(e.scrollTop=c)),this)}function K(a){return a===b||/^(?:body|html)$/i.test(a.tagName)}function L(){return{x:b.pageXOffset||d.scrollLeft,y:b.pageYOffset||d.scrollTop}}function M(a,b){return new H(a,b)}var a=this,b=window,c=b.document,d=c.documentElement,e="parentNode",f=null,g=/^checked|value|selected$/,h=/select|fieldset|table|tbody|tfoot|td|tr|colgroup/i,i="table",j={thead:i,tbody:i,tfoot:i,tr:"tbody",th:"tr",td:"tr",fieldset:"form",option:"select"},k=/^checked|selected$/,l=/msie/i.test(navigator.userAgent),m=[],n=0,o=/^-?[\d\.]+$/,p="px",q="setAttribute",r="getAttribute",s=/(^\s*|\s*$)/g,t={lineHeight:1,zoom:1,zIndex:1,opacity:1},u=function(){var a=["webkitTransform","MozTransform","OTransform","msTransform","Transform"],b;for(b=0;b<a.length;b++)if(a[b]in c.createElement("a").style)return a[b]}(),v=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(s,"")},B=c.defaultView&&c.defaultView.getComputedStyle?function(a,b){b=b=="transform"?u:b,b=b=="transform-origin"?u+"Origin":b;var d=null;b=="float"&&(b="cssFloat");var e=c.defaultView.getComputedStyle(a,"");return e&&(d=e[y(b)]),a.style[b]||d}:l&&d.currentStyle?function(a,b){b=y(b),b=b=="float"?"styleFloat":b;if(b=="opacity"){var c=100;try{c=a.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(d){try{c=a.filters("alpha").opacity}catch(e){}}return c/100}var f=a.currentStyle?a.currentStyle[b]:null;return a.style[b]||f}:function(a,b){return a.style[y(b)]};H.prototype={get:function(a){return this[a]},each:function(a,b){return x(this,a,b)},map:function(a,b){var c=[],d,e;for(e=0;e<this.length;e++)d=a.call(this,this[e],e),b?b(d)&&c.push(d):c.push(d);return c},first:function(){return M(this[0])},last:function(){return M(this[this.length-1])},html:function(a,b){function f(b){while(b.firstChild)b.removeChild(b.firstChild);x(I(a),function(a){b.appendChild(a)})}var c=b?d.textContent===null?"innerText":"textContent":"innerHTML",e;return typeof a!="undefined"?this.each(function(b){(e=b.tagName.match(h))?f(b,e[0]):b[c]=a}):this[0]?this[0][c]:""},text:function(a){return this.html(a,1)},addClass:function(a){return this.each(function(b){E(b,a)||F(b,a)})},removeClass:function(a){return this.each(function(b){E(b,a)&&G(b,a)})},hasClass:function(a){return A(this,function(b){return E(b,a)})},toggleClass:function(a,b){return this.each(function(c){typeof b!="undefined"?b?F(c,a):G(c,a):E(c,a)?G(c,a):F(c,a)})},show:function(a){return this.each(function(b){b.style.display=a||""})},hide:function(a){return this.each(function(a){a.style.display="none"})},append:function(a){return this.each(function(b){x(I(a),function(a){b.appendChild(a)})})},prepend:function(a){return this.each(function(b){var c=b.firstChild;x(I(a),function(a){b.insertBefore(a,c)})})},appendTo:function(a,b){return C.call(this,a,b,function(a,b){a.appendChild(b)})},prependTo:function(a,b){return C.call(this,a,b,function(a,b){a.insertBefore(b,a.firstChild)})},next:function(){return this.related("nextSibling")},previous:function(){return this.related("previousSibling")},related:function(a){return this.map(function(b){b=b[a];while(b&&b.nodeType!==1)b=b[a];return b||0},function(a){return a})},before:function(a){return this.each(function(b){x(M.create(a),function(a){b[e].insertBefore(a,b)})})},after:function(a){return this.each(function(b){x(M.create(a),function(a){b[e].insertBefore(a,b.nextSibling)})})},insertBefore:function(a,b){return C.call(this,a,b,function(a,b){a[e].insertBefore(b,a)})},insertAfter:function(a,b){return C.call(this,a,b,function(a,b){var c=a.nextSibling;c?a[e].insertBefore(b,c):a[e].appendChild(b)})},replaceWith:function(a){return this.each(function(b){b.parentNode.replaceChild(M.create(a)[0],b)})},css:function(a,d,e){function g(a,b,c){for(var d in f)f.hasOwnProperty(d)&&(c=f[d],(b=y(d))&&o.test(c)&&!(b in t)&&(c+=p),b=b=="transform"?u:b,b=b=="transformOrigin"?u+"Origin":b,a.style[b]=c)}if(d===undefined&&typeof a=="string")return d=this[0],d?d==c||d==b?(e=d==c?M.doc():M.viewport(),a=="width"?e.width:a=="height"?e.height:""):B(d,a):null;var f=a;typeof a=="string"&&(f={},f[a]=d),l&&f.opacity&&(f.filter="alpha(opacity="+f.opacity*100+")",f.zoom=a.zoom||1,delete f.opacity);if(d=f["float"])l?f.styleFloat=d:f.cssFloat=d,delete f["float"];return this.each(g)},offset:function(a,b){if(typeof a=="number"||typeof b=="number")return this.each(function(c){D(c,a,b)});var c=this[0],d=c.offsetWidth,e=c.offsetHeight,f=c.offsetTop,g=c.offsetLeft;while(c=c.offsetParent)f+=c.offsetTop,g+=c.offsetLeft;return{top:f,left:g,height:e,width:d}},attr:function(a,b){var c=this[0];if(typeof a=="string"||a instanceof String)return typeof b=="undefined"?g.test(a)?k.test(a)&&typeof c[a]=="string"?!0:c[a]:c[r](a):this.each(function(c){g.test(a)?c[a]=b:c[q](a,b)});for(var d in a)a.hasOwnProperty(d)&&this.attr(d,a[d]);return this},val:function(a){return typeof a=="string"?this.attr("value",a):this[0].value},removeAttr:function(a){return this.each(function(b){k.test(a)?b[a]=!1:b.removeAttribute(a)})},data:function(a,b){var c=this[0];if(typeof b=="undefined"){c[r]("data-node-uid")||c[q]("data-node-uid",++n);var d=c[r]("data-node-uid");return m[d]||(m[d]={}),m[d][a]}return this.each(function(c){c[r]("data-node-uid")||c[q]("data-node-uid",++n);var d=c[r]("data-node-uid"),e=m[d]||(m[d]={});e[a]=b})},remove:function(){return this.each(function(a){a[e]&&a[e].removeChild(a)})},empty:function(){return this.each(function(a){while(a.firstChild)a.removeChild(a.firstChild)})},detach:function(){return this.map(function(a){return a[e].removeChild(a)})},scrollTop:function(a){return J.call(this,null,a,"y")},scrollLeft:function(a){return J.call(this,a,null,"x")},toggle:function(a){return this.each(function(a){a.style.display=a.offsetWidth||a.offsetHeight?"none":"block"}),a&&a(),this}},M.setQueryEngine=function(a){f=a,delete M.setQueryEngine},M.aug=function(a,b){for(var c in a)a.hasOwnProperty(c)&&((b||H.prototype)[c]=a[c])},M.create=function(a){return typeof a=="string"?function(){var b=/^<([^\s>]+)/.exec(a),d=c.createElement(b&&j[b[1].toLowerCase()]||"div"),e=[];d.innerHTML=a;var f=d.childNodes;d=d.firstChild,e.push(d);while(d=d.nextSibling)d.nodeType==1&&e.push(d);return e}():z(a)?[a.cloneNode(!0)]:[]},M.doc=function(){var a=this.viewport();return{width:Math.max(c.body.scrollWidth,d.scrollWidth,a.width),height:Math.max(c.body.scrollHeight,d.scrollHeight,a.height)}},M.firstChild=function(a){for(var b=a.childNodes,c=0,d=b&&b.length||0,e;c<d;c++)b[c].nodeType===1&&(e=b[d=c]);return e},M.viewport=function(){return{width:l?d.clientWidth:self.innerWidth,height:l?d.clientHeight:self.innerHeight}},M.isAncestor="compareDocumentPosition"in d?function(a,b){return(a.compareDocumentPosition(b)&16)==16}:"contains"in d?function(a,b){return a!==b&&a.contains(b)}:function(a,b){while(b=b[e])if(b===a)return!0;return!1};var N=a.bonzo;return M.noConflict=function(){return a.bonzo=N,this},M}),!function(a,b){typeof define=="function"?define("vendor/ender/qwery-mobile",[],b):typeof module!="undefined"?module.exports=b():this[a]=b()}("qwery-mobile",function(){function g(a){return[].slice.call(a,0)}function h(a){return a&&a.nodeType&&(a.nodeType==1||a.nodeType==9)||a===window}function i(a){return typeof a=="object"&&isFinite(a.length)}function j(a){var b=[],c,d;for(c=0,d=a.length;c<d;c++)i(a[c])?b=b.concat(a[c]):b.push(a[c]);return b}function k(a){var b=[],c,d;a:for(c=0;c<a.length;c++){for(d=0;d<b.length;d++)if(b[d]==a[c])continue a;b[b.length]=a[c]}return b}function l(a,e,k){var m=typeof e=="string"?l(e)[0]:i(e)?e[0]:e||b;return!m||!a?[]:b.getElementsByClassName&&a=="string"&&(k=a.match(d))?g(m.getElementsByClassName(k[1])):a==window||a==b?(a=a==b?b:c,e?[null]:[a]):h(a)?!m||f(a,m)?[a]:[]:i(a)?j(a):g(m.querySelectorAll(a))}var a=this,b=document,c=window,d=/^\.([\w\-]+)$/,e=b.documentElement,f="compareDocumentPosition"in e?function(a,b){return(b.compareDocumentPosition(a)&16)==16}:function(a,c){return c=c==b||c==window?e:c,c!==a&&c.contains(a)};l.uniq=k;var m=a.qwery;return l.noConflict=function(){return a.qwery=m,this},l}),define("module/bootstrap",["vendor/events/eventEmitter","vendor/ender/bonzo","vendor/ender/qwery-mobile","config"],function(a,b,c,d){var e=new EventEmitter,f=e.emit;e.emit=function(a,b){return typeof console!="object"||window.location.hostname!=="pal.sandbox.dev.bbc.co.uk"||a==="newListener",f(a,b)};var g={pubsub:e,$:function(a,d){return b(c(a,d))},config:d};return g}),define("module/featureDetector",[],function(){function d(){return/forceVideoSupport/.test(window.location.href)}function e(b,d){return a.hasOwnProperty(d)||(a[d]=c[b+d]?c[b+d]():undefined),a[d]}var a={},b=/OS ([0-9])/,c={isIos:function(){return/(iPod|iPad|iPhone)/.test(navigator.userAgent)},isIosVersion:function(a){var c=b.exec(navigator.userAgent);return c&&c[1]?Number(c[1])>=a?!0:!1:!1},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isAndroidMobile22:function(){return this.isAndroid()&&/Mobile/i.test(navigator.userAgent)&&/2.2/.test(navigator.userAgent)},isIE10:function(){return/MSIE 10/.test(navigator.userAgent)},canUseHistoryApi:function(){return window.history&&window.history.pushState},canPlayHls:function(){return this._canPlayType("application/x-mpegURL")},canPlayAppleHls:function(){return this._canPlayType("application/vnd.apple.mpegurl")&&this.isIos()&&this.isIosVersion(5)},canPlayH264:function(){return this._canPlayType('video/mp4; codecs="avc1.42E01E"')||this.isAndroidMobile22()},_canPlayType:function(a){var b=document.createElement("video");if(b.canPlayType){var c=b.canPlayType(a);if(c==="probably"||c==="maybe")return!0}},isTouchDevice:function(){return"ontouchstart"in window||"onmsgesturechange"in window||window.DocumentTouch&&document instanceof DocumentTouch?!0:!1},isLargeScreen:function(){var a=window.innerWidth>0?window.innerWidth:screen.width;return a>1024?!0:!1}};return{can:function(a){return d()?!0:e("can",a)},is:function(a){return e("is",a)}}}),define("module/history/hashed",["module/bootstrap"],function(a){var b=function(b,c,d){var e=this;this.sessionStorage=d||window.sessionStorage,this.EmittedFromHistory=null,this.queue=[],this.historyPos=0,a.pubsub.on("history:hashchange",function(a){e.manageHashChange(a)}),window.addEventListener("hashchange",function(b){typeof b.newURL=="undefined"&&(b.newURL=window.location.href),a.pubsub.emit("history:hashchange",[b.newURL.split("#")[1]])},!0),window.addEventListener("unload",function(){e.sessionStorage.setItem("news:history:save:"+window.location.pathname,JSON.stringify(e.queue))},!0),this.initState(c),this.addPubSubListeners(b)};return b.prototype.addPubSubListeners=function(b){var c=this,d=function(b){a.pubsub.on(b,function(){c.EmittedFromHistory==b?c.EmittedFromHistory=null:(window.location.href=window.location.pathname+"#"+c.incrementHistoryPos(),c.queue[c.historyPos]={isNewsMobile:!0,eventName:b,eventData:Array.prototype.slice.call(arguments)})})};for(var e=0,f=b.length;e<f;e++)d(b[e])},b.prototype.incrementHistoryPos=function(){return this.historyPos++,this.historyPos},b.prototype.initState=function(b){var c=this.sessionStorage.getItem("news:history:save:"+window.location.pathname);c&&typeof window.location.hash!="undefined"?(this.queue=JSON.parse(c),this.historyPos=window.location.hash.split("#")[1],a.pubsub.emit("history:hashchange",[this.historyPos])):typeof b!="undefined"&&(window.location.href=window.location.pathname+"#"+this.historyPos,this.queue[this.historyPos]={isNewsMobile:!0,eventName:b.eventName,eventData:b.data})},b.prototype.manageHashChange=function(b){var c=this.queue[b];typeof c!="undefined"&&(this.EmittedFromHistory=c.eventName,a.pubsub.emit(c.eventName,c.eventData))},b}),define("module/history/native",["module/bootstrap"],function(a){var b=function(b,c){this.EmittedFromHistory=!1;var d=this,e=function(b){a.pubsub.on(b,function(){d.EmittedFromHistory?d.EmittedFromHistory=!1:window.history.pushState({isNewsMobile:!0,eventName:b,eventData:Array.prototype.slice.call(arguments)},"")})};for(var f=0,g=b.length;f<g;f++)e(b[f]);window.addEventListener("popstate",function(b){b.state&&"isNewsMobile"in b.state&&(d.EmittedFromHistory=!0,a.pubsub.emit(b.state.eventName,b.state.eventData))},!1),typeof c!="undefined"&&window.history.replaceState({isNewsMobile:!0,eventName:c.eventName,eventData:c.data},"")};return b}),define("module/history/history",["require","module/history/native","module/history/hashed"],function(a){return typeof window.history=="object"&&typeof window.history.pushState!="undefined"?a("./native"):a("./hashed")}),define("module/hyperpuff/minihyper",["module/bootstrap"],function(a){var b=4,c=['<aside class="pullout mini-hyper">','<div class="pullout-inner">','<h3 class="heading">{{title}}</h3>','<div class="related-items">{{content}}</div>',"</div>","</aside>"].join(""),d=function(a,b){return c.replace("{{title}}",a).replace("{{content}}",b)};return{init:function(){var c=a.$(".hyperpuff"),e=a.$(".hyper-title",c).text(),f=a.$(".group .unit",c),g=a.$(".story-body .introduction"),h=document.createElement("div"),i=f.length<4?f.length:b;if(c.length){for(var j=0;j<i;j++)h.appendChild(f[j].cloneNode(!0));g.length&&g.before(d(e,h.innerHTML))}}}}),define("module/hyperpuff/hyperpuff",["module/bootstrap","module/hyperpuff/minihyper"],function(a,b){var c=".hyperpuff",d=".fetch-hyperpuff",e=".placeholder-hyperpuff";return function(f){this.transcluder=f,this.currentStoryId=a.$("#page").attr("data-story-id"),this.transcluder.get(d,{maintainLink:!0,target:e,urlParameters:{exclude:this.currentStoryId,flatten:window.innerWidth>640?!1:!0},complete:function(){a.$(c).removeClass("not-fetched").addClass("fetched"),b.init(),a.pubsub.emit("hyperpuff:complete")}})}}),define("module/imageenhancer",["module/bootstrap"],function(a){var b=function(b){typeof b=="string"&&a.$(b).each(function(b){a.$(b).addClass("image-replace")}),this.widths=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,625,660,695,736],this.isResizing=!1,this.imageReplaceNodelist=null;var c=this;this.changeDivsToImgs(),a.pubsub.on("imageEnhancer:resize",function(){c.resizeImages(c.imageReplaceNodelist)}),setTimeout(function(){c.initResizeImages()},250)};return b.prototype={changeDivsToImgs:function(){a.$("div.delayed-image-load").each(function(b,c){b=typeof b!="number"?b:c;var d=b.getAttribute("data-width"),e=b.getAttribute("data-height"),f="";d>0&&e>0&&(f=' width="'+b.getAttribute("data-width")+'" height="'+b.getAttribute("data-height")+'"'),a.$(b).replaceWith('<img src="data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7" datasrc="'+b.getAttribute("data-src")+'" class="image-replace" alt=""'+f+" />")})},initResizeImages:function(){this.imageReplaceNodelist=document.querySelectorAll(".image-replace"),this.resizeImages(this.imageReplaceNodelist),window.addEventListener?window.addEventListener("resize",function(){a.pubsub.emit("imageEnhancer:resize")},!1):window.attachEvent("resize",function(){a.pubsub.emit("imageEnhancer:resize")})},resizeImages:function(a){if(!this.isResizing){this.isResizing=!0;for(var b=0,c=a.length;b<c;b++){if(a[b].getAttribute("class").match("no-replace"))continue;var d=this.calcImgSrc(a[b].getAttribute("datasrc")||a[b].src,a[b].clientWidth);!d||(a[b].src=d)}this.isResizing=!1}},calcImgSrc:function(a,b){if(a===null)return!1;var c=a.match(/\/news\/(ws\/)?(\d*)/)||a;if(c===null||typeof c=="string")return!1;var d=a.indexOf(c[2]),e=c[2].length;return a.substr(0,d)+this.matchBestWidth(b)+a.substr(d+e)},matchBestWidth:function(a){var b=this.widths[0];for(var c=0,d=this.widths.length;c<d;c++){if(a<this.widths[c])return b;b=this.widths[c]}return b}},b}),define("module/liveEvent/timeline",["module/bootstrap","vendor/ender/reqwest"],function(a,b){var c=function(a,c,d,e){e=e||{},this.poller=d,this.view=c,this.channel=a,this.sort=e.sort||"descending",this.active=typeof e.active=="undefined"?!0:!!e.active,this.host=e.pulsarPollingHost||"",this.path=e.pulsarPollingPath||"/news/walkietalkie/pulsar/"+a,this.requestInProgress=!1,this.reqwest=b};return c.prototype={init:function(){var b=this;a.pubsub.on("timeline:more:click",function(){b.requestMoreEntries()}),this.setupPolling()},setupPolling:function(){if(this.sort==="descending"&&this.active){var b=this;this.poller.startCacheBusting(),this.poller.setUrl(this.buildPulsarUrl(!0)),this.poller.startPolling({success:function(c){return a.pubsub.emit("timeline:new:dataReceived",[c]),b.buildPulsarUrl(!0)},error:function(b){a.pubsub.emit("timeline:new:dataError")}})}},requestMoreEntries:function(){var b=this;this.requestInProgress||(this.requestInProgress=!0,this.reqwest({url:this.buildPulsarUrl(!1),type:"jsonp",jsonpCallbackName:"callback",success:function(c){b.requestInProgress=!1,a.pubsub.emit("timeline:more:dataReceived",[c])},error:function(){b.requestInProgress=!1,a.pubsub.emit("timeline:more:dataError")}}))},buildPulsarUrl:function(a){var b={sort:this.sort};return a?(b.entryId=this.view.getTopId(),b.top=!0):b.entryId=this.view.getBottomId(),this.host+this.buildUrl(this.path,b)},buildUrl:function(a,b){var c="";for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];if(!e)continue;c+=d+"="+e+"&"}return c.length>0&&(c=c.substring(0,c.length-1),a=a+"?"+c),a}},c}),define("module/liveEvent/timelineView",["module/bootstrap"],function(a){function c(a){return"#"+a.replace(/(:|\.)/g,"\\$1")}var b=function(b){this.container=a.$(b),this.articleWrapper=this.$(".article-wrapper"),this.moreButton=this.$(".timeline-more a"),this.moreButtonText=this.$(".timeline-more a .cta"),this.windowTopAboveContainerFlag=this.isWindowTopAboveContainer(),this.init(),this.moreButton.append('<span class="spin"></span>')};return b.prototype={init:function(){var b=this;if(this.moreButton.length>0){this.buttonShowMore(),this.moreButton[0].setAttribute("href","#more-button"),this.moreButton[0].addEventListener("click",function(c){return c.preventDefault(),b.moreButton.removeClass("highlighted"),b.buttonLoading(),a.pubsub.emit("timeline:more:click"),!1},!1);var c=function(a,c){b.moreButton[0].addEventListener(a,function(){b.moreButton[c+"Class"]("highlighted")},!1)};c("touchstart","add"),c("touchmove","remove"),c("touchend","remove")}window.addEventListener("scroll",function(){b.hasScrolledAboveContainer()&&a.pubsub.emit("timeline:scroll:top")},!1),window.addEventListener("unload",function(){b.buttonShowMore()},!0),a.pubsub.on("timeline:more:dataReceived",function(a){b.buttonShowMore(),b.appendEntries(a),a.hasMore===!1&&b.buttonHide()}),a.pubsub.on("timeline:new:dataReceived",function(a){b.prependEntries(a),b.handleStickies(a)}),a.pubsub.on("timeline:scroll:top",function(){b.showHiddenEntries()}),a.pubsub.on("timeline:more:dataError",function(){b.buttonError()}),a.pubsub.on("timeline:temp:load",function(){b.buttonLoading()})},handleStickies:function(a){a&&a.stickies&&(this.addStickies(a.stickies),this.removeStickies(a.stickies))},addStickies:function(b){var d=this.$(".sticky-wrapper");for(var e in b)if(b.hasOwnProperty(e)){var f=b[e],g=c(e),h=g+"_stuck";this.$(h).length===0&&(f=f.replace(e,e+"_stuck"),d.prepend(f),this.$(h+" > div").addClass("deleted"));var i=this.$(g);i.length>0&&i.hide()}setTimeout(function(){a.$(".sticky-wrapper .deleted").removeClass("deleted")},500)},removeStickies:function(b){var d=this.$(".sticky-wrapper article");d.each(function(d,e){var f=d.id.replace("_stuck","");f in b||(a.$(d).remove(),a.$(c(f)).show())})},updateButton:function(a,b){this.moreButton.removeClass("loading").removeClass("error"),this.moreButton.addClass(a),this.moreButtonText.html(b)},buttonShowMore:function(){this.updateButton("","Show More")},buttonHide:function(){this.moreButton.hide()},buttonLoading:function(){this.updateButton("loading","Loading")},buttonError:function(){this.buttonShowMore()},getIds:function(){var a=this.$(".article-wrapper article");return a.length>0?a:[]},getTopId:function(){var a=this.getIds();if(a.length>0)return a[0].getAttribute("id")},getBottomId:function(){var a=this.getIds();return a?a[a.length-1].getAttribute("id"):null},appendEntries:function(a){a.text&&this.articleWrapper.append(a.text)},prependEntries:function(a){if(a&&a.text){this.articleWrapper.prepend('<div class="hidden">'+a.text+"</div>");if(this.windowTopAboveContainerFlag){var b=this;setTimeout(function(){b.showHiddenEntries()},500)}}},hasScrolledAboveContainer:function(){var a=this.isWindowTopAboveContainer();return this.windowTopAboveContainerFlag!==a?(this.windowTopAboveContainerFlag=a,a):!1},isWindowTopAboveContainer:function(){var a=this.container[0];if("getBoundingClientRect"in a)return a.getBoundingClientRect().top>0;var b=0;if(a.offsetParent)while(a.offsetParent!==null)a=a.offsetParent,b+=a.offsetTop;else b=a.offsetTop;return b>window.pageYOffset},showHiddenEntries:function(){this.$(".hidden").removeClass("hidden")},$:function(b){return a.$(b,this.container)}},b}),define("module/local/local",["module/bootstrap","vendor/ender/reqwest"],function(a,b){var c=function(b){this.options=b||{},this.options.simple=this.options.simple||!1,this.options.story_limit=this.options.story_limit||2,this.options.append_ext=this.options.append_ext||undefined,a.pubsub.on("locator:locationChanged",this.updateLocalNews,this)};return c.prototype.updateLocalNews=function(c){c&&c.news&&c.news.id&&c.news.path?(a.pubsub.emit("local:requestStarted"),b({url:a.config.pathPrefix+"/"+c.news.path+(this.options.append_ext!==undefined?this.options.append_ext:"")+"?limit="+this.options.story_limit+"&simple="+this.options.simple,type:"html",headers:{"X-Transclude":1},method:"get",success:function(b){a.pubsub.emit("local:newsReceived",[b,c.news.path])},error:function(b){a.pubsub.emit("local:requestError")}})):a.pubsub.emit("local:locationInvalid")},c}),define("locator/bootstrap",["vendor/events/eventEmitter","vendor/ender/bonzo","vendor/ender/qwery-mobile","vendor/ender/reqwest"],function(a,b,c,d){var e=new EventEmitter,f={pubsub:e,$:function(a){return b(c(a))},ajax:d.compat};return f}),define("locator/locatorView",["locator/bootstrap"],function(a){var b,c,d;return b="/locator/default/mobile/en-GB/confirm/",d=function(a){if(!a)return;a.preventDefault?a.preventDefault():a.returnValue=!1},c=function(b,c){c=c||{};var e=this,f='<div id="locator"><form id="locator-form" action="#">';typeof c.pubsub!="undefined"&&(a.pubsub=c.pubsub),this.inputPlaceholderMessage="Enter a UK town or postcode",this.autoCompleteEnabled=!1,!0===c.enableAutoComplete&&(this.autoCompleteEnabled=!0),this.supportsGeoLocation=!1,typeof navigator.geolocation!="undefined"&&c.enableReverseGeocode!==!1&&(this.geoLocationEnabled=!0,this.supportsGeoLocation=!0),this.supportsGeoLocation&&window.locator&&window.locator.disableGeoLocation&&(this.supportsGeoLocation=!1),this.supportsGeoLocation&&(f+='<a href="" id="locator-geolocation"><span class="link-text">Use my current location</span><span class="crosshair"></span></a><p id="geolocation-error"></p>'),f+='<div id="locator-search-container"><span class="locator-search-input"><label for="locator-search">Search Term</label><input id="locator-search-input" name="locator-search" type="text"/></span><input name="locator-submit" class="submit" type="submit" value="Search"/><button id="locator-submit" value="Search">Search <span class="magnifier"></span></button></div></form><p id="locator-message-search"/><ul id="locator-results"></ul><a id="locator-results-more" href="">Show More</a><a id="locator-prompt-change" href="">Change your location<span class="crosshair"></span></a></div>',a.$(b).append(f),this.elm=document.getElementById("locator"),this.form=document.getElementById("locator-form"),this.searchMessage=document.getElementById("locator-message-search"),this.changePrompt=document.getElementById("locator-prompt-change"),this.input=document.getElementById("locator-search-input"),this.results=document.getElementById("locator-results"),this.moreResults=document.getElementById("locator-results-more"),this.supportsPlaceholder=typeof this.input.placeholder!="undefined",this.supportsPlaceholder?this.input.placeholder=this.inputPlaceholderMessage:(this.inputFocusHandler=function(a){e.inputPlaceholderMessage===e.input.value&&(e.input.value="")},this.inputBlurHandler=function(a){""===e.input.value&&(e.input.value=e.inputPlaceholderMessage)},this.createEventListener(this.input,"focus",this.inputFocusHandler,!1),this.createEventListener(this.input,"blur",this.inputBlurHandler,!1)),this.autoCompleteView=null,this.autoCompleteEnabled&&require(["locator/autoCompleteView"],function(a){e.autoCompleteView=new a}),this.geolocation=null,this.supportsGeoLocation&&(this.geolocation=a.$("#locator-geolocation")[0],this.geolocationMessage=a.$("p#geolocation-error")[0]),this.formHandler=function(a){var b=e.input.value;return 0<b.length&&(e.clearResults(),e.sendSearchData(b.toLowerCase(),0)),d(a),!1},this.createEventListener(this.form,"submit",this.formHandler,!1),this.resultsHandler=function(a){var b,c,f;return d(a),b=(a.target||a.srcElement).href,b&&0<b.length&&(matches=b.match(/confirm\/(\w{0,2}\d+)\/?(\w+)?/),3===matches.length&&(f=matches[2]),2<=matches.length&&(c=matches[1],e.sendLocationData(c,f))),!1},this.createEventListener(this.results,"click",this.resultsHandler,!1),this.moreResultsHandler=function(b){d(b),e.moreResultsEnabled&&(a.$("#locator-results-error").remove(),e.disableMoreResults(),e.sendSearchData(e.currentResults.searchTerm,e.currentResults.offset+e.currentResults.limit))},this.createEventListener(this.moreResults,"click",this.moreResultsHandler,!1),this.supportsGeoLocation&&(this.geolocationClickHandler=function(b){d(b),e.geoLocationEnabled&&(e.clearResults(),e.disableGeolocation("active"),navigator.geolocation.getCurrentPosition(function(b){a.pubsub.emit("locator:geoLocation",[b])},function(a){e.setMessage(e.geolocationMessage,"Unable to detect your location","error"),e.enableGeolocation()},{enableHighAccuracy:!0,maximumAge:60,timeout:1e4}))},this.createEventListener(this.geolocation,"click",this.geolocationClickHandler,!1)),this.createEventListener(this.changePrompt,"click",function(b){a.pubsub.emit("locator:changeLocationPrompt"),e.renderForm(),d(b)},!1),a.pubsub.on("locator:searchResults",function(a){e.renderSearchResults(a)}),a.pubsub.on("locator:newsLocalRegions",function(a){e.renderNewsLocalRegions(a)}),a.pubsub.on("locator:locationOutOfContext",function(a){e.setMessage(e.searchMessage,null),e.setMessage(e.geolocationMessage,"Sorry, location setting is not available for your location","error")}),a.pubsub.on("locator:renderForm",function(){e.renderForm()}),a.pubsub.on("locator:renderChangePrompt",function(){e.renderStopWait(),e.resetForm(),e.renderChangePrompt()}),a.pubsub.on("locator:renderWait",function(){e.renderWait()}),a.pubsub.on("locator:error",function(a,b){e.renderError(a,b)})},c.prototype={sendSearchData:function(b,c){a.pubsub.emit("locator:submitSearch",[b,c])},sendLocationData:function(b,c){a.pubsub.emit("locator:submitLocation",[b,c])},close:function(){this.elm.parentNode.removeChild(this.elm)},clearResults:function(){this.setMessage(this.searchMessage,null),this.setMessage(this.geolocationMessage,null),this.currentResults=null,this.results.innerHTML="",this.moreResults.style.display="none"},renderChangePrompt:function(){this.setFormIsShown(!1),this.setChangePromptIsShown(!0)},renderForm:function(){this.setFormIsShown(!0),this.setChangePromptIsShown(!1),this.resetForm()},resetForm:function(){this.input.value=this.supportsPlaceholder?"":this.inputPlaceholderMessage,this.clearResults(),this.setMessage(this.searchMessage,null),this.enableGeolocation()},disableForm:function(){this.destroyEventListener(this.form,"submit",this.formHandler),this.createEventListener(this.form,"submit",function(a){return d(a),!1},!1),a.$("#locator-search-container").addClass("disabled"),a.$(this.input).attr("disabled",!0)},setFormIsShown:function(a){var b;b=a?"block":"none",this.form.style.display=b},setChangePromptIsShown:function(a){this.changePrompt.style.display=a?"block":"none"},enableMoreResults:function(){this.moreResultsEnabled=!0,a.$(this.moreResults).removeClass("disabled")},disableMoreResults:function(){this.moreResultsEnabled=!1,a.$(this.moreResults).addClass("disabled")},enableGeolocation:function(){this.geoLocationEnabled=!0,a.$(this.geolocation).removeClass("active")},disableGeolocation:function(b){this.geoLocationEnabled=!1,b=b||"disabled",a.$(this.geolocation).addClass(b)},setMessage:function(a,b,c){a&&(typeof c=="string"&&c.length>0&&(a.className=c),a.style.display=null===b||""===b?"none":"block",a.innerHTML=b)},renderError:function(b,c){var d="Sorry an error has occurred, please try again";"autocomplete"!==c&&this.renderStopWait();if(b&&b.flagpoles){if(!b.flagpoles.locator){this.clearResults(),this.disableForm(),this.disableGeolocation(),this.setMessage(this.searchMessage,"Sorry location setting is not currently available","error");return}if(!b.flagpoles.reverseGeocode){this.disableGeolocation(),this.setMessage(this.geolocationMessage,'Sorry the "use my current location" feature is not currently available',"error");if("geolocate"===c)return}}"geolocate"===c?(this.setMessage(this.geolocationMessage,"Sorry an error occurred trying to detect your location. Please try again","error"),this.enableGeolocation()):"search"===c&&this.currentResults?a.$(this.moreResults).after('<p id="locator-results-error" class="error">'+d+"</p>"):"autocomplete"!==c&&this.setMessage(this.searchMessage,d,"error")},renderWait:function(){this.currentResults||this.setMessage(this.searchMessage,"Please wait...")},renderStopWait:function(){this.currentResults||this.setMessage(this.searchMessage,null)},renderSearchResults:function(c){var d,e,f="",g=b,h="?ptrt="+window.location,i=!1;this.currentResults=c,this.renderStopWait(),this.enableGeolocation();if(0===c.results.length)this.setMessage(this.searchMessage,'There were no results for "'+c.searchTerm+'"');else{this.setMessage(this.searchMessage,"Search results:");for(e=0;e<c.results.length;e++)d=c.results[e],f+='<li><a href="'+g+d.id+h+'">'+d.name+"</a></li>"}this.results.style.display="",0===c.offset?(this.results.innerHTML=f,this.setFocusOnFirstResult(),i=c.limit<c.total):(a.$(this.results).append(f),i=c.offset+c.limit<c.total),this.moreResults.style.display=i?"block":"none",i&&this.enableMoreResults()},renderNewsLocalRegions:function(a){var c,d,e="",f=b+a.location.id+"/",g="?ptrt="+window.location;this.renderStopWait(),this.enableGeolocation(),this.setMessage(this.searchMessage,"Your chosen location falls between two News Regions. To set your location, please select one of the regions below.");for(d=0;d<a.regions.length;d++)c=a.regions[d],e+='<li><a href="'+f+c.id+g+'">'+c.name+"</a></li>";this.results.style.display="",this.results.innerHTML=e,this.setFocusOnFirstResult()},setFocusOnFirstResult:function(){var b;b=a.$("#locator-results li a"),b.length>0&&b[0].focus()},createEventListener:function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},destroyEventListener:function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)}},c}),define("vendor/istats/istats",[],function(){function u(a){return typeof a.istats=="undefined"&&(a.istats={}),typeof a.istats.enabled=="undefined"&&(a.istats.enabled=!0),a}function v(a){return a?u(a).istats:window.istats}function w(){if(typeof t=="string")return h.type="internal",t}function x(a){history.replaceState?history.replaceState({},"",document.location.pathname+a):document.location.hash=a}function y(a){a||(a=document.location.hash);if(a!==""){var b=a.match(m.clickThrough),c,d="",e=[];if(b===null)return;b[2]&&(d="#"+b[2]),x(d),c=b[1];if(c==="")return;h.type="click through",e=c.split("&");for(var f in e)e.hasOwnProperty(f)&&!m.hashLabels.test(e[f])&&(e[f]="ct_"+e[f]);return c=e.join("&"),c}}function z(){var a=!0,b=!0,c=v().enabled;return window.bbcFlagpoles_istats&&(b=window.bbcFlagpoles_istats!=="ON"),b||!c?a=!1:A(),a}function A(){return!c&&typeof istatsTrackingUrl!="undefined"&&(c=istatsTrackingUrl),c}function B(a,b){return a.className?(" "+a.className+" ").indexOf(" "+b+" ")===-1?!1:!0:!1}function C(a,b){var c=a.className?a.className+" ":"";B(a,b)||(a.className=c+b)}function D(a,b){var c=a.className.split(" "),d=[],e=c.length;while(e--)c[e]!==b&&d.unshift(c[e]);a.className=d.length?d.join(" "):""}function E(a){var b=a.match(m.domain);return b?b[1]:a}function F(a,b){var c=a;do{if(c.nodeName=="A")return c;if(c===b)return!1}while(c=c.parentNode)}function G(a){if(!b._isWebUrl(a))return;if(b._isExternal(a))return"external";if(b._isDownload(a))return"download";if(b._isInternal(a))return"internal"}function H(a,b,c,d,e){a.istats={linkType:b,linkTrackerUrl:c,linkLocation:d,linkElement:e}}function I(a,b,c,d){var e=d.altKey||d.ctrlKey||d.metaKey||d.shiftKey,f=function(){};e||(f=function(){o.notify(b,"redirect.istats",d)!==!1&&(window.location.href=c.href)}),clearTimeout(l),l=setTimeout(function(){o.notify(b,"trackingfail.istats",d),f()},i),J(a,function(){clearTimeout(l),o.notify(b,"trackingsuccess.istats",d)!==!1&&f()},d),e||(d.preventDefault?d.preventDefault():event.returnValue=!1)}function J(a,b,c){var d;a+="&ns__t="+(new Date).getTime(),a+="&ns_jspageurl="+escape(document.location&&document.location.href?document.location.href:document.URL),c&&c.istats.linkTrackerUrl&&(c.istats.linkTrackerUrl=a),d=new Image,typeof b=="function"&&(d.onload=function(){b()}),h.url=a,d.src=a,d.className="tracking-image",document.body.appendChild(d)}function K(a){if(typeof a[f]!="undefined")return;a[f]={eventsKey:r.length,linkTypesTracked:{}},r.push(s())}function L(a,b,c){var d=new Date,e=31536e6,f=window.location.host,g,h,i;return typeof c=="undefined"&&(c=e),d.setTime(d.getTime()+c),h="; expires="+d.toGMTString(),g=E(f),i=a+"="+encodeURIComponent(b)+h+"; domain="+g+"; path=/",document.cookie=i,i}function M(a){var b=a+"=",c=document.cookie.split(";"),d;for(var e=0,f=c.length;e<f;e++){d=c[e];while(d.charAt(0)===" ")d=d.substring(1,d.length);if(d.indexOf(b)===0)return decodeURIComponent(d.substring(b.length,d.length))}return null}function N(a){M(a)!==null&&L(a,"",-1)}var a={},b=a,c,d="sa_labels",e="istats-notrack",f="_istats_"+Math.random(),g={internal:!0,external:!0,download:!0,clickthrough:!0,promoimage:!0},h={type:"",url:""},i=2e3,j=1e4,k=500,l,m={ignore:/.+\.(jpe?g|gif|png)$/i,webUrl:/^(\.\.?\/|\/|https?:\/\/|[^\/.:]+([\/.]|$))/i,pseudoProtocol:/^(mailto:|javascript:|about:|view-source:|data:)/i,internalUrl:/^(?:\/\/|https?:\/\/)?(?:[^.]+\.)*(bbc(?:\.co\.uk|\.com)|doubleclick\.net)(:|\/|$)/i,downloadUrl:/.+\.(pdf|te?xt|rtf|docx?|xlsx?|pptx?|od[tpsgbf]|mp[234]|m4a|mpeg|exe|dmg|zip|tgz)$/i,relativeUrl:/^(\.\.?\/|\/[^\/]|([^\/.:]+([\/.]|$)))/i,clickThrough:/^#sa-(.*?)(?:-sa(.*))?$/,hashLabels:/^ct_|ns_(fee|campaign|linkname|mchannel|source)=(.+?)$/,domain:/(bbc(?:\.co\.uk|\.com))$/i},n={},o={types:{"trackingfail.istats":!0,"trackingsuccess.istats":!0,"redirect.istats":!0,"cookiecreated.istats":!0}},p={},q={},r=[],s=function(){var a={};for(var b in o.types)a[b]=[];return a},t=M(d);return u(window),t!==null&&(v()._linkTracked=!0),z()&&A(),N(d),a.getConfig=v,a._setTrackingServiceUrl=A,a._getTrackingServiceUrl=function(){return c},a.setCountername=function(a){c=c.replace(/([\?&]name=)[^&]*/ig,"$1"+a)},a.getCountername=function(){var a=c.match(/[\?&]name=([^&]*)/i);if(a)return a[1]},a.track=function(a,b){if(!z())return;if(!g[a])throw'Given linkType, "'+a+'" is not valid.';b=b||{},b.region||(b.region=[document.body]),typeof b.region.push=="undefined"&&(b.region=[b.region]);var c=b.region.length;while(c--){var d=b.region[c];K(d,a);var e=d[f];e.linkTypesTracked[a]=b||{},e.trackerAttached||(function(a){n.attach(a,"click",function(b){q.dispatch(a,b)})}(d),e.trackerAttached=!0)}},a.observe=function(a,b,c){if(!o.types[b])throw'Cannot observe: Given eventType, "'+b+'" in unknown.';typeof a.push=="undefined"&&(a=[a]);var d=a.length;while(d--)K(a[d]),r[a[d][f].eventsKey][b].push(c)},a._isInternal=function(b){return a._isWebUrl(b)&&(m.relativeUrl.test(b)||m.internalUrl.test(b))},a._isExternal=function(c){return a._isWebUrl(c)&&!b._isInternal(c)},a._isDownload=function(a){return m.webUrl.test(a)&&m.downloadUrl.test(a)},a._isWebUrl=function(a){return m.webUrl.test(a)&&!m.ignore.test(a)&&!m.pseudoProtocol.test(a)},a._getDomainFromHost=E,a._getLabelsFromHashString=y,a._createCookie=L,a._inspectTracking=function(a){return typeof a!="undefined"&&(h=a),h},a.log=function(b,d,e,f){var g="",i;if(!z())return;d=encodeURIComponent(d),b=encodeURIComponent(b);for(var j in e)g+="&"+encodeURIComponent(j)+"="+encodeURIComponent(e[j]);b.toLowerCase()==="pageview"?(a.setCountername(d),i=c):i=c+"&ns_type=hidden"+"&action_type="+b+"&action_name="+d,i+=g,h.type="logging actions",J(i,f)},a.addNoTrack=function(a){C(a,e)},a.removeNoTrack=function(a){D(a,e)},o.notify=function(a,b,c){var d=r[a[f].eventsKey][b];for(var e=0,g=d.length;e<g;e++)if(typeof d[e]=="function"&&d[e](c)===!1)return!1},n.attach=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},n.detach=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null},n.getTarget=function(a){return a=a||window.event,a.target||a.srcElement},q.dispatch=function(a,b){var c=F(n.getTarget(b),this),d,g,h,i,j;if(!c||!c.href)return;i=(new Date).getTime(),j=c.istatsTimestamp&&i-c.istatsTimestamp<k;if(j||B(c,e))return;d=G(c.href),g=q[d],h=a[f].linkTypesTracked[d];if(!d||!g||!h)return;c.istatsTimestamp=i,b.istats=b.istats||{},q[d](a,c,b)},q.external=function(a,b,d){var e=a[f].linkTypesTracked.external||{},g=encodeURIComponent(b.href)||"",i=b.id?"&extlink_id="+encodeURIComponent(b.id):"",j=e.linkLocation?"&link_location="+encodeURIComponent(e.linkLocation):"",k=c+"&ns_type=hidden&action_type=extlink&extlink_url="+g+i+j;h.type="external",H(d,"external",k,e.linkLocation,b),I(k,a,b,d)},q.download=function(a,b,d){var e=a[f].linkTypesTracked.download||{},g=encodeURIComponent(b.href)||"",i=b.id?"&download_id="+encodeURIComponent(b.id):"",j=e.linkLocation?"&link_location="+encodeURIComponent(e.linkLocation):"",k=c+"&ns_type=hidden&action_type=download&download_url="+g+i+j;h.type="download",H(d,"download",k,e.linkLocation,b),I(k,a,b,d)},q.internal=function(a,b,c){var e=a[f].linkTypesTracked.internal||{},g="intlink_from_url="+encodeURIComponent(document.location.href),h="&intlink_ts="+(new Date).getTime(),i=b.id?"&intlink_id="+encodeURIComponent(b.id):"",k=b.linktrack?"&"+b.linktrack:"",l=e.linkLocation?"&link_location="+encodeURIComponent(e.linkLocation):"",m=g+h+i+k+l;L(d,m,j),o.notify(a,"cookiecreated.istats",c)},a.init=function(){var a;if(!z()&&typeof c!="string")return;a=w()||y(),a&&(J(c+"&"+a),v()._linkTracked=!0)},a}),define("locator/stats",["vendor/istats/istats"],function(a){var b,c,d,e;return c=function(b,c){typeof c=="undefined"&&(c=!1),a.log(b,"locator",c)},b=function(a,b){d=a,typeof b=="function"&&(c=b)},b.prototype.applyEvents=function(){d.on("locator:open",function(){c("open",{supports_geolocation:typeof navigator.geolocation!="undefined"?1:0})}),d.on("locator:changeLocationPrompt",function(){c("open")}),d.on("locator:geoLocation",function(a){c("geo_location",{latitude:a.coords.latitude,longitude:a.coords.longitude})}),d.on("locator:searchResults",function(a){var b;typeof a.offset=="undefined"&&(a.offset=0),typeof a.limit=="undefined"&&(a.limit=10),b={ns_search_term:a.searchTerm,offset:a.offset,page_num:(a.offset+a.limit)/a.limit},b.page_num>1?c("more_results",b):c("search",b)}),d.on("locator:submitAutoCompleteSearch",function(a){var b;b={ns_search_term:a},c("autocomplete_search",b)}),d.on("locator:submitAutoCompleteLocation",function(a,b){var d;d={location_id:a,location_name:b},c("autocomplete_click",d)}),d.on("locator:error",function(){c("http_error")}),d.on("locator:locationChanged",function(a){var b;if(a===null)return;b={location_id:a.id,location_name:a.name},a.local_region&&(b.news_region=a.local_region),c("confirm",b)}),d.on("locator:newsLocalRegions",function(a){var b,d,e;b={location_id:a.location.id,location_name:a.location.name},e=[];for(d in a.regions)a.regions.hasOwnProperty(d)&&e.push(a.regions[d].name);b.location_regions=e.join(", "),c("news_local_regions",b)})},b}),define("locator/main",["locator/bootstrap","locator/locatorView","locator/stats"],function(bootstrap,LocatorView,Stats){function doRequest(url,success,actionType,complete){typeof complete=="function"&&(complete=function(){}),bootstrap.ajax({url:url,crossOrigin:!0,dataType:"json",method:"get",success:success,error:function(e){var responseText=e&&e.responseText?e.responseText:"{}";try{response=window.JSON?window.JSON.parse(responseText):eval("("+responseText+")")}catch(err){response=null}bootstrap.pubsub.emit("locator:error",[response,actionType])},complete:complete})}var newsMap={3:"england/berkshire",4:"england/birmingham_and_black_country",7:"england/bristol",8:"england/cambridgeshire",11:"england/cornwall",12:"england/coventry_and_warwickshire",13:"england/cumbria",16:"england/derbyshire",17:"england/devon",18:"england/dorset",19:"scotland/edinburgh_east_and_fife",20:"england/essex",22:"scotland/glasgow_and_west",23:"england/gloucestershire",26:"world/europe/guernsey",27:"england/hampshire",28:"england/hereford_and_worcester",30:"scotland/highlands_and_islands",31:"england/humberside",32:"world/europe/isle_of_man",33:"world/europe/jersey",34:"england/kent",35:"england/lancashire",36:"england/leeds_and_west_yorkshire",37:"england/leicester",38:"england/lincolnshire",39:"england/merseyside",40:"england/london",41:"england/manchester",42:"wales/mid_wales",43:"england/norfolk",44:"england/northamptonshire",45:"scotland/north_east_orkney_and_shetland",46:"wales/north_east_wales",21:"northern_ireland",47:"wales/north_west_wales",49:"england/nottingham",50:"england/oxford",57:"england/south_yorkshire",51:"england/shropshire",52:"england/somerset",53:"wales/south_east_wales",55:"scotland/south_scotland",56:"wales/south_west_wales",58:"england/stoke_and_staffordshire",59:"england/suffolk",66:"england/surrey",60:"england/sussex",61:"scotland/tayside_and_central",62:"england/tees",1:"england/beds_bucks_and_herts",63:"england/tyne_and_wear",65:"england/wiltshire",48:"england/york_and_north_yorkshire"},Locator=function(a){var b,c,d,e,f;b=this,e=!1,a=a||{},this.host=a.host||"",this.getLocation(),a.pubsub&&(bootstrap.pubsub=a.pubsub),f=new Stats(bootstrap.pubsub),f.applyEvents(),bootstrap.pubsub.on("locator:open",function(d){e||(e=!0,c=new LocatorView(d,{enableReverseGeocode:a.enableReverseGeocode!==!1,enableAutoComplete:a.enableAutoComplete!==!1}),b.location?bootstrap.pubsub.emit("locator:renderChangePrompt"):bootstrap.pubsub.emit("locator:renderForm"))}),bootstrap.pubsub.on("locator:close",function(a){e&&(e=!1,c.close(),c=null)}),bootstrap.pubsub.on("locator:geoLocation",function(a){b.geoLocate(a.coords.latitude,a.coords.longitude)}),bootstrap.pubsub.on("locator:submitSearch",function(a,c){b.search(a,c)}),bootstrap.pubsub.on("locator:submitLocation",function(a,c){b.checkLocation(a,c)}),bootstrap.pubsub.on("locator:submitAutoCompleteSearch",function(a){b.autoComplete(a)}),bootstrap.pubsub.on("locator:submitAutoCompleteLocation",function(a,c){b.checkLocation(a,null)})};return Locator.prototype.open=function(a){bootstrap.pubsub.emit("locator:open",[a])},Locator.prototype.close=function(){bootstrap.pubsub.emit("locator:close")},Locator.prototype.handleLocation=function(a){var b;a.cookie&&a.expires&&(b="locserv="+a.cookie+"; expires="+(new Date(a.expires*1e3)).toUTCString()+"; path=/; domain=.bbc.co.uk",this.setCookieString(b),this.hasParsedCoookie=!1),bootstrap.pubsub.emit("locator:renderChangePrompt"),bootstrap.pubsub.emit("locator:locationChanged",[this.getLocation()])},Locator.prototype.checkLocation=function(a,b){bootstrap.pubsub.emit("locator:renderWait");var c=this,d=this.host+"/locator/news/responsive/location.json?id="+a;b&&(d+="&newsRegion="+b),doRequest(d,function(a){c.handleResponse(a)},"location")},Locator.prototype.handleResponse=function(a){"search_results"===a.type?bootstrap.pubsub.emit("locator:searchResults",[a]):"autocomplete_search_results"===a.type?bootstrap.pubsub.emit("locator:autoCompleteSearchResults",[a]):"news_regions"===a.type?bootstrap.pubsub.emit("locator:newsLocalRegions",[a]):"geolocation"===a.type?a.isWithinContext||bootstrap.pubsub.emit("locator:locationOutOfContext",[a]):"location"===a.type&&this.handleLocation(a)},Locator.prototype.search=function(a,b){var c=this.host+"/locator/news/responsive/search.json?search="+a,d=this;b&&(c+="&offset="+b),bootstrap.pubsub.emit("locator:renderWait"),doRequest(c,function(a){d.handleResponse(a)},"search")},Locator.prototype.autoComplete=function(a){var b=this.host+"/locator/news/responsive/autocomplete.json?search="+a,c=this;doRequest(b,function(a){c.handleResponse(a)},"autocomplete")},Locator.prototype.geoLocate=function(a,b){var c=this.host+"/locator/news/responsive/geolocate.json?"+"latitude="+a+"&longitude="+b,d=this;bootstrap.pubsub.emit("locator:renderWait"),doRequest(c,function(a){d.handleResponse(a)},"geolocate")},Locator.prototype.getCookieString=function(){return document.cookie},Locator.prototype.setCookieString=function(a){document.cookie=a},Locator.prototype.getLocation=function(){var a,b,c,d,e;return this.hasParsedCoookie?this.location:(e=function(a){var b,c,d,e={};a=a.substr(3),c=a.split(":");for(b=0;b<c.length;b++)d=c[b].split("="),d[1]=d[1].replace(/\+/g,"%20"),e[d[0]]=decodeURIComponent(d[1]);return e},a=this.getCookieString().match("locserv=(.*?)(;|$)"),a?(b=a[1].substr(2).split("@"),c=e(b[0]),d=e(b[3]),newsPath=newsMap[d.r],weather=e(b[1]),this.location={id:c.i,name:c.n,news:{id:d.r,path:newsPath},weather:{id:weather.i}},this.hasParsedCoookie=!0,this.location):null)},Locator}),define("module/media/empFacade",["module/bootstrap","config"],function(a,b){return function(c){var d=function(a,d){this.config=d?d:b?b:{},this.options=a||{},c=="bump"?this.embedUrl="http://emp.bbci.co.uk/emp/bump/define.js?emp=worldwide&enableClear=1&enableMobile=1":c=="clear"&&(this.embedUrl="http://emp.bbci.co.uk/emp/clear/embed.js"),this.options.isLead?(this.options.width||(this.options.width=window.innerWidth>640?480:320),this.options.height||(this.options.height=window.innerWidth>640?270:180)):(this.options.width||(this.options.width=window.innerWidth>640?464:304),this.options.height||(this.options.height=window.innerWidth>640?261:171)),this.embed()};return d.prototype={getAsset:function(){var a=this.config||{},b=this.config.asset||{};return b},getPageType:function(){var a=this.getAsset(),b=a.type||null,c={MAP:"eav1",STY:"eav2",IDX:"eav3"};return c[b]?c[b]:0},getEdition:function(){var a=this.getAsset(),b=a.edition||null;return b?b:0},embed:function(){var b=this;require([this.embedUrl],function(c){var d=new c.Player;d.setWidth(b.options.width),d.setHeight(b.options.height),d.setDomId(b.options.id),d.setPlaylist(b.options.playlist),d.setMediator({host:"open.live.bbc.co.uk"}),b.options.poster&&d.setBoilerPlateUrl(b.options.poster),d.set("uxHighlightColour","0xcc0101"),d.set("enable3G",!0),d.set("showFullScreenButton",!0),d.set("config_plugin_api_javascript",!0),d.set("config_plugin_fmtjLiveStats_pageType",b.getPageType()),d.set("config_plugin_fmtjLiveStats_edition",b.getEdition()),d.write(),d.onMediaPlayerInitialised=function(){a.pubsub.emit("video:load",[d]),d.register("onEnterFullscreen"),d.onEnterFullscreen=function(){a.pubsub.emit("nav:all:close")},d.register("onMediaPlaying"),d.onMediaPlaying=function(){a.pubsub.emit("video:play",[d])},d.register("onMediaPaused"),d.onMediaPaused=function(){a.pubsub.emit("video:pause",[d])},d.register("onMediaCompleted"),d.onMediaCompleted=function(){a.pubsub.emit("video:end",[d])}}})}},d}}),define("module/media/mediaRegistry",[],function(){return{data:null,find:function(a){return this.data[a]}}}),define("module/media/piratePlayerView",["module/bootstrap","vendor/ender/bonzo"],function(a,b){var c=/Android/i.test(navigator.userAgent),d=!/2\.\d/i.test(navigator.userAgent),e={AUDIO:"Audio playback is unsupported on your device",LIVE:"Live streaming is unsupported on your device",CONTENT:"This content is unavailable",DEFAULT:"Media playback is unsupported on your device"},f=function(b){this.opts=b||{},this.player=this.createPlayer(),this.playButton=this.createPlayButton(),this.interval=null,this.container=a.$("#"+b.id)};return f.prototype={createPlayer:function(){var a=document.createElement("video");return a.setAttribute("preload","none"),this.opts.href&&a.setAttribute("src",this.opts.href),a},createPlayButton:function(){var c=a.$(b.create('<button class="video-cta">Play</button>'));return c},createPoster:function(a){var b=document.createElement("img");return b.className="poster",b.src=a,b},createErrorMessage:function(a){var b=document.createElement("p");return b.className="error-message",b.innerHTML=a,b},renderError:function(a){this.poster=this.createPoster(this.opts.poster),this.error=this.createErrorMessage(a),this.container.append(this.poster),this.container.append(this.error)},showError:function(a){switch(a){case"audio":this.renderError(e.AUDIO);break;case"live":this.renderError(e.LIVE);break;case"content":this.renderError(e.CONTENT);break;default:this.renderError(e.DEFAULT)}},embed:function(){this.poster=this.createPoster(this.opts.poster),this.container.append(this.player),this.container.append(this.poster),this.container.append(this.playButton),a.pubsub.emit("video:load",[this]),this.bindEvents()},bindEvents:function(){var b=this;this.poster.addEventListener("click",function(){b.player.play(),b.player.webkitEnterFullscreen&&b.player.webkitEnterFullscreen()},!1),this.player.addEventListener("play",function(){a.pubsub.emit("video:play",[b]),b.fullScreenSupported()&&d&&b.startPollingForFullScreen()}),this.player.addEventListener("ended",function(){a.pubsub.emit("video:end",[b]),b.fullScreenSupported()&&b.player.webkitDisplayingFullscreen&&(b.exitFullScreenSupported()&&b.player.webkitExitFullScreen(),b.player.pause(),this.interval&&clearInterval(b.interval))}),this.player.addEventListener("pause",function(){a.pubsub.emit("video:pause",[b])})},fullScreenSupported:function(){return"webkitDisplayingFullscreen"in this.player},exitFullScreenSupported:function(){return"webkitExitFullScreen"in this.player},startPollingForFullScreen:function(){var a=this;this.interval=setInterval(function(){a.player.webkitDisplayingFullscreen||(a.player.pause(),clearInterval(a.interval))},1e3)}},f}),define("module/media/piratePlayer",["module/bootstrap","module/media/piratePlayerView","vendor/ender/reqwest"],function(a,b,c){var d=function(a){this.options=a||{},this.mediaType=this.options.mediaType;var b=this;this.isPlayable()&&b.getMediaSelector(function(a){var c=b.createMediaView(a);c.embed()},function(a){view=b.createMediaView(a),view.showError("content")})};return d.prototype={errorOnRender:function(){return this.options.errorOnRender},isAudio:function(){return this.mediaType==="audio"},isLive:function(){return this.options.live},isPlayable:function(){var a;return this.isAudio()?(a=this.createMediaView(),a.showError("audio"),!1):this.isLive()?(a=this.createMediaView(),a.showError("live"),!1):this.errorOnRender()?(a=this.createMediaView(),a.showError(),!1):!0},createMediaView:function(a){return a=a||{},this.options.href=a.href,new b(this.options)},getMediaSelector:function(a,b){var d=this.getMediaSelectorUrl(),e=this;c({url:d,type:"jsonp",method:"get",jsonpCallback:"jsfunc",jsonpCallbackName:"process",success:function(c){var d=e.proccessMediaSelector(c);d?a(d):b(d)},error:function(a){b()}})},getMediaSelectorUrl:function(){return["http://open.live.bbc.co.uk","/mediaselector/5/select/version/2.0","/format/json","/vpid/",this.options.externalId,"/mediaset/journalism-http-mobile","/transferformat/plain","/jsfunc/process"].join("")},proccessMediaSelector:function(a){if(!a)return;if(!a.media)return;var b={};for(var c=a.media.length-1;c>=0;c--){var d=a.media[c].bitrate;b[d]={},b[d].href=a.media[c].connection[0].href}return b[512]?b[512]:b[496]||b[176]}},d}),define("module/media/mediaLoader",["module/bootstrap","module/media/empFacade","module/media/piratePlayer","module/featureDetector"],function(a,b,c,d){var e=function(){var a=[/Blackberry/i,/Opera/i,/Firefox/i,/webOS/i],b=navigator.userAgent;for(var c=0,d=a.length;c<d;c++)if(a[c].test(b))return!0;return!1},f=['<figure class="{{classes}}">','<div class="media-container media-wrapper" id="media-{{id}}">',"</div>",'<figcaption><span class="cap">{{caption}}</span></figcaption>',"</figure>"].join(""),g=function(a,b){for(var c in b)a=a.replace(new RegExp("{{"+c+"}}","g"),b[c]);return a},h=function(b,c,d,e){this.forceErrorMessages=d.forceErrorMessages,this.player=e||this.selectPlayer(),this.player&&(this.$placeholder=a.$(b),this.isLead=this.$placeholder.hasClass("lead-video-placeholder"),this.id=b.id,this.meta=c||{},this.options=d||{},this.mediaType=this.options.mediaType||"video",this.hasCaption=!!this.meta.caption&&!!this.meta.caption.length,this.caption=this.hasCaption?this.meta.caption:"",this.posterSrc=this.meta.image&&this.meta.image.href?this.meta.image.href:undefined,this.render())};return h.prototype={selectPlayer:function(){if(e()){if(this.forceErrorMessages)return this.errorOnRender=!0,c;return}if(!d.is("TouchDevice")&&d.is("LargeScreen")||d.is("IE10"))return b("bump");if(d.can("PlayAppleHls"))return b("clear");if(d.can("PlayH264"))return c;if(this.forceErrorMessages)return this.errorOnRender=!0,c;return},render:function(){this.renderContainer(),this.embedPlayer()},renderContainer:function(){var a=this.player==c?"default-player ":"responsive-player ";a+=this.hasCaption?"has-caption":"no-caption",this.$placeholder.append(g(f,{classes:a,id:this.id,caption:this.caption})),this.show()},embedPlayer:function(){var a=new this.player({id:"media-"+this.id,playlist:this.meta.href,externalId:this.meta.externalId,poster:this.meta.image.href,live:this.meta.live,width:this.options.width,height:this.options.height,empEvents:this.options.empEvents,mediaType:this.mediaType,controls:!0,isLead:this.isLead,errorOnRender:this.errorOnRender||!1})},show:function(){this.$placeholder.addClass("enabled")}},h}),define("module/media/mediaHandler",["module/bootstrap","module/media/mediaLoader"],function(a,b){var c=function(a,c,d){this.registry=a,this.options=c||{},this.players=[],b=d||b};return c.prototype={createMedia:function(){var a=this.findMediaElements();for(var c=a.length-1;c>=0;c--){var d=a[c],e=this.getMeta(d.id),f=d.getAttribute("data-media-type"),g={mediaType:f};if(this.options.audio===!1&&f==="audio")continue;e&&(this.players.push=new b(d,e,g))}},getMeta:function(a){return this.registry.find(a)},findMediaElements:function(){return document.querySelectorAll(".media-placeholder")}},c}),define("module/mediaAssetPage/api",["module/bootstrap","vendor/ender/reqwest"],function(a,b){var c=function(){var b=this;a.pubsub.on("map:asset:load",function(a){b.request(a,"asset")}),a.pubsub.on("map:feed:load",function(a,c,d){b.request(a,"feed")})};return c.prototype={request:function(d,e,f){a.pubsub.emit("map:request:start",[d,e]),b({url:a.config.pathPrefix+"/api/av/"+e+"/"+d,method:"get",type:"json",success:function(b){b.feed&&(b=b.feed),f&&f(b),a.pubsub.emit("map:"+e+":request:success",[d,b])},error:function(b){a.pubsub.emit("map:"+e+":request:error",[d,b])}})}},c}),define("module/mediaAssetPage/map",["module/bootstrap"],function(a){return{init:function(){this.liveStats=a.$("#livestats");var b=this;a.pubsub.on("map:asset:request:success",function(a,c){b.updateLiveStats(c.beacon),b.updateShareTools(c.shareTools)})},updateLiveStats:function(a){var b=this.liveStats.attr("src").split("?")[0]+"?";this.liveStats.attr("src",b+a)},updateShareTools:function(b){a.$(".share-this").replaceWith(b)}}}),define("module/nav/nav",["module/bootstrap"],function(a){var b=function(a,b){this.button=a,this.nav=b,this.state=!1,this.name=this.button&&this.button.attr?this.button.attr("data-event"):"",this.setupBindings(),this.setupListeners()};return b.prototype={getName:function(){return this.name},setupListeners:function(){a.pubsub.on("nav:all:close",this.close,this),a.pubsub.on(this.getEventName("close"),this.close,this),a.pubsub.on("nav:all:open",this.open,this),a.pubsub.on(this.getEventName("open"),this.open,this),a.pubsub.on("tabs:click",this.close,this)},setupBindings:function(){var b=this;this.button[0].addEventListener("click",function(c){c.preventDefault(),b.state?a.pubsub.emit(b.getEventName("close")):a.pubsub.emit(b.getEventName("open"))},!1),this.nav[0].addEventListener("click",function(c){a.pubsub.emit(b.getEventName("close"))},!1)},toggle:function(){a.$("body").toggleClass(this.getOpenClass())},close:function(){this.state=!1,a.$("body").removeClass(this.getOpenClass())},open:function(){a.$("body").hasClass(this.getOpenClass())||(a.pubsub.emit("nav:all:close"),this.state=!0,a.$("body").addClass(this.getOpenClass()))},getOpenClass:function(){return"nav-"+this.getName()+"-open"},getEventName:function(a){return"nav:"+this.getName()+":"+a}},b}),define("module/poller",["module/bootstrap","vendor/ender/reqwest"],function(a,b){function d(a){var b="cachebuster="+Math.floor((new Date).getTime()/1e3);return a.indexOf("?")>0?a+"&"+b:a+"?"+b}function e(a){var b=!1;return"clientdirective"in a&&"pollPeriod"in a.clientdirective&&(b=a.clientdirective.pollPeriod),"pollPeriod"in a&&(b=a.pollPeriod),b}var c=function(a,b){if(Object.prototype.toString.call(a)!=="[object Number]")throw new Error("Update frequency must be a number");this.updateFrequency=a,this.polling=!1,this.timeout=b||1e4,this.cacheBusting=!1};return c.prototype={setUrl:function(a){this.url=a},buildUrl:function(){return this.cacheBusting?d(this.url):this.url},setPollingTime:function(a){this.updateFrequency=a},startPolling:function(a){this.polling=!0,this.options=a||{},this.poll()},stopPolling:function(){this.polling=!1},poll:function(){if(this.polling){var a=this;b({url:a.buildUrl(),type:"jsonp",timeout:this.timeout,jsonpCallbackName:"callback",method:"get",success:function(b){var c=e(b);c?(a.updateFrequency=c,a.rePoll()):a.stopPolling();if(a.options.success){var d=a.options.success(b);a.url=d||a.url}},error:function(b){a.options.error&&a.options.error(b),a.rePoll()}})}},rePoll:function(){var a=this;window.setTimeout(function(){a.poll()},a.updateFrequency)},stopCacheBusting:function(){this.cacheBusting=!1},startCacheBusting:function(){this.cacheBusting=!0}},c}),define("module/rollingNews",["module/bootstrap","vendor/ender/reqwest"],function(a,b){return{init:function(){function j(b,c){a.$(".unit__link-wrapper",b).each(function(b){var d=c[a.$(b).attr("href")];d&&a.$(".unit__body-text",b.nextElementSibling).append(d)})}function k(a,b,c){a.className.match(b)?c(a):(a=a.parentNode,k(a,b,c))}function m(b){e=b,f=b.querySelector(".unit__accordion");if(d)b.className.match(/a-loading/)?o("loading",b):(p(),a.$(".share-this").hide(),b.className+=" a-loading animated-gif css-anim",g=document.createElement("div"),g.className+="spin",f.appendChild(g),h=!0);else if(b.className.match(/a-open/))o("open",b);else{p();var c=b.querySelectorAll(".unit__body-text, .share-this"),j=function(a){a.stopPropagation()};for(i=0,l=c.length;i<l;i++)c[i].addEventListener("click",j);n(h,b)}}function n(b,c){if(b){a.$(".share-this").show(),c.className=c.className.replace(" a-loading animated-gif css-anim",""),c.className+=" a-open",q(!1),f.style.height="auto";var d=f.offsetHeight;f.style.height=80,q(!0),f.style.height=d+"px",f.removeChild(g)}else{c.className+=" a-open",f.style.height="auto";var d=f.offsetHeight;f.style.height=0,f.style.height=d+"px",setTimeout(function(){q(!1),f.style.height="auto",setTimeout(function(){q(!0)},10)},300)}}function o(a,b){if(a=="loading")b.className=b.className.replace(" a-loading animated-gif css-anim",""),f.style.height=0,e=undefined;else if(a=="open"){b.className=b.className.replace(" a-open","");var c=f.offsetHeight;q(!1),f.style.height=c+"px",setTimeout(function(){q(!0),f.style.height=0},10)}}function p(){var a=document.querySelectorAll(".unit--rolling-news .unit__body");for(i=0,l=a.length;i<l;i++)a[i].className="unit__body",a[i].querySelector(".unit__accordion").style.height=""}function q(a){a===!0?f.className=f.className.replace(" no-animation",""):a===!1&&(f.className+=" no-animation")}var c,d=!1,e,f,g,h=!1;c=document.querySelector(".rolling-news .units-list");if(!c)return;d=!0,b({url:"/russian/api/rolling_news.json?limit="+a.$("div.unit",c).length,headers:{"X-Transclude":1},method:"GET",success:function(a){j(c,a),d=!1,h&&(m(e),h=!1)},error:function(a){d=!1},complete:function(a){d=!1},timeout:5e3}),c.addEventListener("click",function(a){a.preventDefault(),(a.target.className=="unit__body"||a.target.className=="unit__link-wrapper"||a.target.className=="unit__header"||a.target.className=="unit__title"||a.target.className=="cta"||a.target.className=="unit__meta"||a.target.className.match(/date/)||a.target.className=="unit__accordion-button")&&k(a.target,/unit__body/,m)})}}}),define("module/stats/statsConfig",[],function(){var a=function(a){var b="";return typeof a.getFlashVersion=="function"?b=a.getFlashVersion()=="0"?"emp-clear":"emp-flash":b="rmp",b};return{links:[{name:"top-stories",selector:"#top-stories"},{name:"features-and-analysis",selector:".features-and-analysis"}],pageviews:[{on:"tabs:activate:mostread",countername:"news.popular.read.page"},{on:"tabs:activate:topstories",countername:"news.page"},{on:"tabs:activate:livetext",countername:function(a){return a.replace(/(\d+).*$/,"$1.page")}},{on:"tabs:activate:keypoints",countername:function(a){return a.replace(/(\d+).*$/,"$1.keypoints.page")}},{on:"tabs:activate:contribute",countername:function(a){return a.replace(/(\d+).*$/,"$1.contribute.page")}},{on:"map:asset:request:success",countername:function(a,b,c){return c.countername||a}}],hidden:[{on:"nav:top:open",action_name:"top_navigation_open"},{on:"nav:bottom:open",action_name:"bottom_navigation_open"},{on:"locator:submitSearch",action_name:"news.locator"},{on:"locator:geoLocation",action_name:"news.locator"},{on:"video:load",action_type:"video",action_name:"load",labels:function(b){return{player_name:a(b)}}},{on:"video:play",action_type:"video",action_name:"play",labels:function(b){return{player_name:a(b)}}},{on:"video:pause",action_type:"video",action_name:"pause",labels:function(b){return{player_name:a(b)}}},{on:"video:end",action_type:"video",action_name:"end",labels:function(b){return{player_name:a(b)}}},{on:"tabs:activate:maprelated",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"related"}},{on:"tabs:activate:maptopstories",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"topstories"}},{on:"tabs:activate:mapmostwatched",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"mostwatched"}},{on:"map:index:toggle",action_type:"toggle",action_name:"map-index",labels:function(a,b){return{section:a,toggle:b}}},{on:"map:asset:summary",action_type:"toggle",action_name:"map-asset-summary",labels:function(a){return{toggle:a}}},{on:"map:index:topstories",action_type:"toggle",action_name:"map-index-topstories",labels:function(a){return{toggle:a}}}]}}),define("module/stats/statsSubscriber",["module/bootstrap"],function(a){function b(a,b,c){var d=this;this.config=a||{},this.document=c||document,this.addCTMLabelForIStats(),require(["vendor/istats/istats"],function(a){d.istats=b||a,d.pageviews=[],d.hidden=[],d.links=[],d.istats.init(),d.processConfig()})}return b.prototype={addCTMLabelForIStats:function(){this.document.cookie="sa_labels="+encodeURIComponent("ctm=true")+";"},addPageviews:function(a){for(var b=0;b<a.length;b++){var c=a[b];this.pageviews.push(c),this.registerPageview(c)}},addHidden:function(a){for(var b=0;b<a.length;b++){var c=a[b];this.hidden.push(c),this.registerHiddenEvent(c)}},addTrackingLinks:function(a){for(var b=0;b<a.length;b++){var c=a[b];this.links.push(c),this.registerTrackingLink(c)}},applyCountername:function(a,b){var c=this.istats.getCountername(),b=Array.prototype.slice.call(b);return b.unshift(c),a.apply(this,b)},applyLabels:function(a,b){return a.apply(this,b)},registerPageview:function(b){var c=this,d=b.on,e=b.countername;a.pubsub.on(d,function(){newCountername=typeof e=="function"?c.applyCountername(e,arguments):e,c.istats.log("pageview",newCountername)})},registerHiddenEvent:function(b){var c=this,d=b.on,e=b.action_type||"event",f=b.action_name,g=b.labels||{};a.pubsub.on(d,function(){newLabels=typeof g=="function"?c.applyLabels(g,arguments):g,c.istats.log(e,f,newLabels)})},registerTrackingLink:function(a){var b=a.type||"internal",c=a.name,d=document.querySelectorAll(a.selector);this.istats.track(b,{region:d,linkLocation:c})},processConfig:function(){var a=this.config.pageviews||{};this.addPageviews(a);var b=this.config.hidden||{};this.addHidden(b);var c=this.config.links||{};this.addTrackingLinks(c)}},b}),define("module/tabbed/panel",["vendor/ender/bonzo","vendor/ender/qwery-mobile"],function(a,b){function c(c){return a(b(c))}var d=function(a){this.hide=function(){a.removeClass("open"),a.addClass("closed")},this.show=function(){a.removeClass("closed"),a.addClass("open")}};return d}),define("module/tabbed/tab",["module/bootstrap","vendor/ender/bonzo","vendor/ender/qwery-mobile","module/tabbed/panel"],function(a,b,c,d){function e(a){return b(c(a))}function f(a){return typeof a=="object"&&isFinite(a.length)}function g(a){return f(a)?e(a[0]):e(a)}var h=function(b,c,e){this.tabId=typeof e!="undefined"?e:"",this.t=g(b),this.p=new d(g(c)),this.selected=!1,this.dataEvent=this.t.attr("data-event")||!1;var f=this;this.click=function(b){b.preventDefault(),a.pubsub.emit("tabs:click"),this.selected||a.pubsub.emit("tabs:activate",[f.tabId])},this.t[0].addEventListener("click",this.click,!0),a.pubsub.on("tabs:deactivate",function(){f.deactivate()}),a.pubsub.on("tabs:activate",function(a){a===f.tabId&&f.activate()})};return h.prototype.activate=function(b){this.selected=!0,a.pubsub.emit("tabs:deactivate"),this.t.addClass("open"),this.p.show(),!b&&this.dataEvent&&a.pubsub.emit("tabs:activate:"+this.dataEvent)},h.prototype.deactivate=function(){this.selected=!1,this.t.removeClass("open"),this.p.hide()},h}),define("module/tabbed/tabbed",["module/tabbed/tab"],function(a){var b=function(b,c){this.tabs=[];var d="";for(var e=0,f=b.length;e<f;e++)this.tabs.push(new a(b[e],c[e],e));this.tabs[0].activate(!0)};return b.prototype.addTab=function(b,c){this.tabs.push(new a(b,c,this.tabs.length))},b}),define("module/transclude",["module/bootstrap","vendor/ender/reqwest"],function(a,b){var c=function(){};return c.prototype.reqwest=b,c.prototype.get=function(b,c){function e(a,b,d){c[a]&&c[a](b,d)}function f(){d.shift(),d.length===0&&e("complete")}function g(a){a+="?";for(var b in c.urlParameters)a+=b+"="+c.urlParameters[b]+"&";return a.slice(0,-1)}c=c||{};var d=[];!function(h){a.$(b).each(function(b,i){b=typeof b!="number"?b:i;if(!b.href){e("error","Error: No href attribute on  elm "+i,i);return}d.push(i);var j=b.href,k=a.$(c.target||b),l=c.maintainLink||!1;c.urlParameters&&(j=g(b.href)),h.reqwest({url:j,type:"html",headers:{"X-Transclude":1},success:function(a){l||b.setAttribute("href","#"+(b.id||"transcluded"+(new Date).getTime())),c.insert?k.html(a):k.replaceWith("<div>"+a+"</div>"),f(),e("success",a,i)},error:function(a){f(),e("error","Error: 404",i)}})})}(this)},c}),define("module/translations/hausa",{oneHourAgo:"Sa'a 1 da ya wuce",xhoursAgo:"Sa'o'i {x} da suka wuce",oneMinuteAgo:"Minti 1 da ya wuce",xminutesAgo:"Mintuna {x} da suka wuce",lessThanAMinuteAgo:"Kasa da minti daya da ya wuce",changeYourLocation:"Sauya yankin da kake",enterTownPostcode:"Shigar da adireshinka",loading:"Yana hawa",localNewsAndWeather:"Labarai da yanayi",localNewsCouldNotBeLoaded:"An gaza samar da labarai",pleaseWait:"A dakata...",retry:"A sake gwada wa",search:"Binciko",sendAnotherComment:"Aiko da wani tsokacin",showMore:"Nuna kari",locationSettingNotAvailable:"A yi hakuri, babu tsarin zabar bigire a yankin da kake",useMyLocationNotAvailable:'A yi hakuri, amfani da tsarin "wurin da nake" ba ya aiki yanzu',anErrorHasOccured:"A yi hakuri an samu kuskure, a sake gwada wa",locationSettingIsNotCurrentlyAvailable:"A yi hakuri, tsarin bigiren da ake ba ya aiki a yanzu",errorTryingToDetectLocation:"A yi hakuri, an samu kuskure a kokarin gani inda kake. A sake gwada wa",searchResults:"Sakamakon bincike",searchTerm:"Kalmomin Bincike",section:"Sassa",noResults:"Babu sakamako ga",thereWasAProblem:"Akwai kuskure, a sake gwada wa.",unableToDetectLocation:"An kasa gano wurin da kake",useMyLocation:"Yi amfani da wurin da nake",locationBetweenCountries:"Bigiren da ka zaba ya fada tsakanin yankuna biyu. Domin seta bigire, zabi yankin da ke kusa da kai don ci gaba."}),define("module/translations/indonesia",{oneHourAgo:"1 jam lalu",xhoursAgo:"{x} jam lalu",oneMinuteAgo:"1 menit lalu",xminutesAgo:"{x} menit lalu",lessThanAMinuteAgo:"Kurang dari satu menit lalu",changeYourLocation:"Ubah lokasi Anda",enterTownPostcode:"Masukkan asal kota",errorNoHrefAttribute:"Error: No href attribute on element",error404:"Error: 404 Halaman tidak ditemukan",loading:"Sedang ditampilkan",localNewsAndWeather:"Berita lokal dan Cuaca",localNewsCouldNotBeLoaded:"Berita lokal tidak dapat ditampilkan",pleaseWait:"Mohon tunggu…",retry:"Coba lagi",search:"Cari",sendAnotherComment:"Kirim komentar lain",showMore:"Tampilkan lebih banyak",locationSettingNotAvailable:"Maaf, setting lokasi tidak tersedia untuk lokasi Anda",useMyLocationNotAvailable:'Maaf, tombol "gunakan lokasi saya" tidak tersedia saat ini',anErrorHasOccured:"Maaf terjadi kesalahan, mohon coba lagi",locationSettingIsNotCurrentlyAvailable:"Maaf setting lokasi saat ini tidak tersedia",errorTryingToDetectLocation:"Maaf terjadi kesalahan untuk mendeteksi lokasi. Mohon coba lagi.",searchResults:"Hasil pencarian",searchTerm:"Istilah pencarian",section:"Kategori",noResults:"Tidak ada hasil untuk",thereWasAProblem:"Ada masalah, mohon coba lagi",unableToDetechLocation:"Tidak dapat mendeteksi lokasi Anda",updateFrequencyMustBeANumber:"Frekuensi perbarui laman harus menggunakan angka",useMyLocation:"Gunakan lokasi saya",locationBetweenCountries:"Lokasi yang Anda pilih terletak antara dua negara. Untuk menentukan lokasi Anda, pilih negara terdekat untuk melanjutkan."}),define("module/translations/news",{oneHourAgo:"1 hour ago",xhoursAgo:"{x} hours ago",oneMinuteAgo:"1 minute ago",xminutesAgo:"{x} minutes ago",lessThanAMinuteAgo:"Less than a minute ago",changeYourLocation:"Change your location",enterTownPostcode:"Enter a UK town or postcode",loading:"Loading",localNewsAndWeather:"Local News &amp; Weather",localNewsCouldNotBeLoaded:"Local news could not be loaded",pleaseWait:"Please wait...",retry:"Retry",search:"Search",sendAnotherComment:"Send another comment",showMore:"Show More",locationSettingNotAvailable:"Sorry, location setting is not available for your location",useMyLocationNotAvailable:'Sorry the "use my location" feature is not currently available',anErrorHasOccured:"Sorry an error has occured, please try again",locationSettingIsNotCurrentlyAvailable:"Sorry location setting is not currently available",errorTryingToDetectLocation:"Sorry an error occured trying to detect your location. Please try again",searchResults:"Search results:",searchTerm:"Search Term",section:"Sections",noResults:"There were no results for",thereWasAProblem:"There was a problem, please try again.",unableToDetectLocation:"Unable to detect your location",useMyLocation:"Use my location",locationBetweenCountries:"Your chosen location falls between two counties. To set your location please select your nearest county to continue."}),define("module/translator",[],function(){function c(c,d){if(!c)throw b.TRANSLATION_UNDEFINED;if(!a(c))throw b.TRANSLATION_NOT_AN_OBJECT;this.translation=c,this.service=d||"news"}var a=function(a){return Object.prototype.toString.call(a)==="[object Object]"},b={TRANSLATION_UNDEFINED:"Translator Error: Translator expects a translation object as its first parameter",TRANSLATION_NOT_AN_OBJECT:"Translator Error: Translator expects an object literal as its first parameter"};return c.prototype.get=function(a){return this.translation[a]?this.translation[a]:null},c.prototype.getService=function(){return this.service},c}),define("translator",["module/translator","config","module/translations/news","module/translations/hausa","module/translations/indonesia","module/translations/russian"],function(a,b,c,d,e,f){var g={hausa:d,indonesia:e,russian:f};return new a(g[b.service]||c,b.service)}),define("module/ajaxForm/ajaxForm",["module/bootstrap","vendor/ender/reqwest","config","translator"],function(a,b,c,d){var e=a.$,f=function(){this.reqwest=b,this.errorMessage=d.get("thereWasAProblem");var c=this;a.pubsub.on("ajaxForm:submit",function(a,b){c.submit(a,b)})};return f.prototype.submit=function(b,c){var d=this;a.pubsub.emit("ajaxForm:renderWait"),this.reqwest({url:c+".json",type:"json",method:"post",data:b,success:function(b){var c=b.body;switch(b.reply){case"success":a.pubsub.emit("ajaxForm:success",[c]);break;case"feedback":a.pubsub.emit("ajaxForm:feedback",[c]);break;default:a.pubsub.emit("ajaxForm:error",[c])}},error:function(b){a.pubsub.emit("ajaxForm:error",[d.errorMessage,b])}})},f}),define("module/ajaxForm/ajaxFormView",["module/bootstrap","translator"],function(a,b){function d(a){return!!a.match(/(INPUT|TEXTAREA)/)}function e(a){var b=a.target;if(d(b.nodeName)){var e=a.type.toLowerCase()=="focus"?"add":"remove";c(b.parentNode)[e+"Class"]("input-has-focus"),f(b)}}function f(a){var b=c(a.parentNode);c(a).val()?b.addClass("input-has-content"):b.removeClass("input-has-content")}"undefined"==typeof String.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var c=a.$,g=function(g){var h=this;this.trans=b,this.elm=c(g),this.url=this.elm[0].action,this.fields=c("input, textarea",this.elm),c(".submit button",this.elm)[0].addEventListener("click",function(){h.elm.addClass("feedback")},!0),this.elm[0].addEventListener("submit",function(a){return h.sendFormData(),a.preventDefault(),!1},!1),this.elm[0].addEventListener("focus",e,!0),this.elm[0].addEventListener("blur",e,!0),this.elm[0].addEventListener("keyup",function(a){var b=a.target;d(b.nodeName)&&f(b)},!1),a.pubsub.on("ajaxForm:success",function(a){h.renderSuccess(a)}),a.pubsub.on("ajaxForm:feedback",function(a){h.renderFeedback(a)}),a.pubsub.on("ajaxForm:error",function(a,b){h.renderError(a)}),a.pubsub.on("ajaxForm:showForm",function(){h.renderForm()}),a.pubsub.on("ajaxForm:renderWait",function(){h.renderWait()})};return g.prototype={sendFormData:function(){var b=this.elm[0].querySelectorAll("input, textarea"),c=[];for(var d in b)c.push(b[d].name+"="+b[d].value);a.pubsub.emit("ajaxForm:submit",[c.join("&").replace(/&(undefined|item|namedItem)=undefined/g,""),this.url])},renderFeedback:function(a){c("p.feedback",this.elm).remove(),this.elm.addClass("feedback"),this.renderStopWait(),this.fields.each(function(b){!a[b.name]||(c(b).val(c(b).val().trim()),c(b.parentNode).addClass("invalid"),f(b),c(b.parentNode).append('<p class="feedback">'+a[b.name]+"</p>"))})},renderSuccess:function(b){this.elm.removeClass("feedback"),this.elm.addClass("successful-submit"),this.renderStopWait(),this.elm.before('<div id="successMsg"><p>'+b+'</p><button><span class="cta">'+this.trans.get("sendAnotherComment")+"</span></button></div>"),c("#successMsg button")[0].addEventListener("click",function(){a.pubsub.emit("ajaxForm:showForm")},!1)},renderForm:function(){c("#"+this.elm[0].id+" fieldset p").remove(),this.fields.each(function(a){a.value="",f(a)}),this.elm.removeClass("successful-submit").removeClass("error"),c("#successMsg, #errorMsg").remove()},renderWait:function(){this.elm.addClass("wait"),c("fieldset",this.elm).removeClass("invalid"),c("#successMsg, #errorMsg").remove(),this.elm.append('<div class="spin"></div>')},renderStopWait:function(){this.elm.removeClass("wait"),c(".spin",this.elm).remove()},renderError:function(a){this.elm.removeClass("feedback"),this.elm.addClass("error"),this.renderStopWait(),this.elm.before('<div id="errorMsg"><p>'+a+'</p><button><span class="cta">'+this.trans.get("retry")+"</span></button></div>");var b=this;c("#errorMsg button")[0].addEventListener("click",function(){b.sendFormData()},!1)}},g}),define("module/live-event",["config","module/bootstrap","module/liveEvent/timeline","module/liveEvent/timelineView","module/poller","module/tabbed/tabbed","module/transclude","module/ajaxForm/ajaxForm","module/ajaxForm/ajaxFormView","module/history/history"],function(a,b,c,d,e,f,g,h,i,j){return{init:function(a,k,l,m,n){(function(){var a=["Webkit","Moz"],c=[];for(var d in a)c.push(document.body.style[a[d]+"AnimationName"]);b.$("html").addClass(c.indexOf("")>-1?"css-anim":"animated-gif")})();var o=b.$,p=o("#live-tabs li"),q=o("#live-panels .panel"),r=new f(Array(p[0],p[1],p[2]),Array(q[1],q[0],q[2])),s=new g,t=new c(a,new d("#live-timeline"),new e(k),{sort:l,active:m,pulsarPollingHost:n}),u=new j(["tabs:activate"],{eventName:"tabs:activate",data:[0]});t.init(),o(".tab-3 a")[0].href+="?transcluded=true",s.get(".tab-3 a",{target:"#contribute-placeholder",success:function(){var a=new h,b=new i("#join-discussion")}})}}}),define("module/nav/navManager",["module/bootstrap","module/nav/nav","translator"],function(a,b,c){return{init:function(){this.bottomNav=a.$("#site-nav"),this.topButton=a.$("#nav-button"),this.topNavPlaceholder=a.$("#site-nav-panel .dropdown"),this.createFooterButton(c.get("section")),this.cloneNavToHead(),this.createNavs()},createFooterButton:function(b){this.bottomNav.before('<span class="button-nav-footer" data-event="bottom">'+b+"</span>"),this.bottomButton=a.$(".button-nav-footer")},cloneNavToHead:function(){var b=this.bottomNav[0].cloneNode(!0);this.bottomNav.addClass("site-nav-foot"),this.topNavPlaceholder.append(b),this.topNav=a.$(b)},createNavs:function(){var a=new b(this.topButton,this.topNav),c=new b(this.bottomButton,this.bottomNav)}}}),define("module/timestamp",["module/bootstrap","translator"],function(a,b){var c=function(a){this.time=a,this.insertTime()};return c.prototype.insertTime=function(){var b=document.querySelectorAll(".date");for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e.getAttribute("data-timestamp-inserted")!==undefined&&a.$(".live",e.parentElement).length===0){var f=e.getAttribute("data-seconds");if(typeof f!==undefined){var g=Math.abs(Math.ceil(this.time/1e3-parseInt(e.getAttribute("data-seconds"),10))),h=this.timeAgoInWords(g);if(h!==null)e.innerHTML=h,e.className+=" relative-time";else if(e.innerHTML===""){var i=document.createElement("p");i.innerHTML=e.getAttribute("data-datetime"),i.className=e.className,e.parentNode.insertBefore(i,e)}e.setAttribute("data-timestamp-inserted",!0)}}}},c.prototype.russianRelativeTime=function(a,b,c,d){var e=a%10;return e==1&&(a==1||a>20)?b:e>1&&e<5&&(a>20||a<10)?c:d},c.prototype.minutesAgo=function(a){switch(b.getService()){case"russian":return this.russianRelativeTime(a,b.get("singularMinutesAgo"),b.get("genSingularMinutesAgo"),b.get("genPluralMinutesAgo")).replace("{x}",a);default:return a==1?b.get("oneMinuteAgo"):b.get("xminutesAgo").replace("{x}",a)}},c.prototype.hoursAgo=function(a){switch(b.getService()){case"russian":return this.russianRelativeTime(a,b.get("singularHoursAgo"),b.get("genSingularHoursAgo"),b.get("genPluralHoursAgo")).replace("{x}",a);default:return a==1?b.get("oneHourAgo"):b.get("xhoursAgo").replace("{x}",a)}},c.prototype.timeAgoInWords=function(a){var c=Math.floor(a/60),d=Math.floor(a/3600);return c<1?b.get("lessThanAMinuteAgo"):d<1?this.minutesAgo(c):d<10?this.hoursAgo(d):null},c}),define("module/live-event-component",["module/bootstrap","module/poller","module/timestamp"],function(a,b,c){return{init:function(d,e){var f=a.$;f("[data-channel]").each(function(){function l(){return d+"/news/walkietalkie/latest_index_asset/"+i}var a=f(".article-inner",this),g=f(".live-event-summary",a),h=f(".live-event-entries",a),i=f(this).attr("data-channel"),j=new b(3e4),k="";j.startCacheBusting(),j.setUrl(l()),j.startPolling({success:function(a){h.html().length===0&&g.remove();if(a.entryId!=k){var b=null;if(a.createTime){var d=a.createTime.split(/[\-T:]/g),f=new Date(d[0],d[1]-1,d[2]);f.setHours(d[3],d[4],d[5]);var i=((new Date).getTime()-f.getTime())/1e3,j=new c(null),m=j.timeAgoInWords(i);m&&(b='<em class="entry-timestamp">'+m+"</em>")}if(b){var n=a.html.indexOf(">")+1,o=a.html.substring(0,n),p=a.html.substring(n);a.html=o+b+p}return e?e(h,a.html):(h.css("opacity","0"),setTimeout(function(){h.html(a.html).css("opacity","1")},1200)),k=a.entryId,l()}},error:function(){h.html().length===0&&(h.css("display","none"),g.css("visibility","visible"),j.stopPolling())}})})}}}),define("module/local/localView",["module/bootstrap","module/timestamp","module/imageenhancer","config","translator"],function(a,b,c,d,e){var f=function(b,c){this.container=a.$(b,c);if(!this.container.length)return;this.moduleTitle=a.$(".local-weather-location",c),this.hideLocal(),a.pubsub.on("local:requestStarted",this.handleLoading,this),a.pubsub.on("local:newsReceived",this.handleSuccess,this),a.pubsub.on("local:requestError",this.handleError,this)};return f.prototype={handleLoading:function(){this.setContent(null,"loading")},handleSuccess:function(a,b){this.showLocal(),this.setContent(a),b&&this.setTitle(b)},handleError:function(){this.setContent(e.get("localNewsCouldNotBeLoaded"),"error")},setTitle:function(b){var c=a.$("#local-stories",this.container);c&&c.attr("data-title")&&(title='<a href="{{link}}" class="local-weather-location-action has-right-arrow"><span class="cta local-weather-location-label">{{title}}</span></a>'.replace("{{link}}","/news/"+b).replace("{{title}}",c.attr("data-title")),this.moduleTitle.html(title))},setContent:function(a,d){d&&(a='<div class="'+d+'">'+(a||"")+"</div>"),this.container.html(a),imageEnhance=new c,timestamp=new b((new Date((new Date).toUTCString())).getTime())},hideLocal:function(){this.container.addClass("hidden")},showLocal:function(){this.container.removeClass("hidden")}},f}),define("module/mediaAssetPage/assetView",["module/bootstrap","module/media/mediaLoader","module/timestamp","config"],function(a,b,c,d){function h(b){l(b),timeStamp=new c((new Date((new Date).toUTCString())).getTime()),a.pubsub.on("map:asset:request:success",m),a.pubsub.on("map:asset:request:error",n),a.pubsub.on("map:asset:load",function(){e("#media-asset-page-video figure").remove()}),k()}function i(a){e(".story-inner .more-wrapper").css("display","block"),e(".story-inner .more-text").text(g.text.moreInfo);var b=e(".map-body",a),c=1;a.addClass("contains-more-text"),b.append('<div class="hide-wrapper hidden"></div>');var d=e(".hide-wrapper",a);e(".map-body > *",a).each(function(){c===0&&!e(this).hasClass("hide-wrapper")?d.append(this):--c}),b.removeClass("display-feature-phone-only")}function j(){var b=e(".story-inner"),c=e("#media-asset-page-text",b),d=e(".map-body",c),f='<div class="more-wrapper" style="display: none;"><a class="more-text" href="#" title="'+g.text.moreInfo+'">'+g.text.moreInfo+"</a></div>";b.append(f),e(".more-text",b)[0].addEventListener("click",function(b){var d=e(b.target),f=e(".hide-wrapper",c);f.toggleClass("hidden"),f.hasClass("hidden")?(a.pubsub.emit("map:asset:summary",["close"]),d.text(g.text.moreInfo)):(a.pubsub.emit("map:asset:summary",["open"]),d.text(g.text.lessInfo)),b.preventDefault()})}function k(){var a=e(".story-inner"),b=e("#media-asset-page-text",a);moreButton=e(".more-text",a),noMapBodyChildren=e(".map-body > *",b).length,noMapBodyChildren<=1||noMapBodyChildren==2&&e(".map-body .related-items",b).length>0?(e(".map-body",b).removeClass("display-feature-phone-only"),moreButton.css("display","none"),b.removeClass("contains-more-text")):(e(".more-text",a).length===0&&j(),i(b))}function l(a){var c,d=a.videos?a.videos:a.audios,e=d==a.videos?"video":"audio";for(var f in d.primary)if(d.primary.hasOwnProperty(f)){c=d.primary[f];break}var g=new b("#media-asset-page-video",c,{width:"100%",height:"100%",mediaType:e,forceErrorMessages:!0})}function m(a,b){l(b.media);var c=e("#media-asset-page-text");e("#media-asset-page-text").html(b.body),timeStamp.insertTime(),k(),window.scrollTo(0,1)}function n(a,b,c){}var e=a.$,f,g={text:{moreInfo:"More information",lessInfo:"Less information"}};return{init:h}}),define("module/mediaAssetPage/listView",["module/bootstrap","module/featureDetector","vendor/ender/bonzo","module/tabbed/tabbed","vendor/ender/reqwest","module/timestamp","config"],function(a,b,c,d,e,f,g){function m(a,b,c){c(b)===!1&&a.preventDefault()}function n(a,b){window.history.pushState({title:b,path:a},null,a)}function o(b,c){document.title=c,a.pubsub.emit("map:asset:load",[b.replace("/news/","")])}function p(c){l=c,k=new f((new Date((new Date).toUTCString())).getTime()),a.pubsub.on("map:feed:request:success",y),a.pubsub.on("map:feed:request:error",z),a.pubsub.on("map:asset:request:success",B),a.pubsub.on("tabs:activate",v),b.can("UseHistoryApi")&&(n(window.location.pathname,document.title),window.addEventListener("popstate",function(a){a.state!==null&&a.state.title&&a.state.path&&o(a.state.path,a.state.title)}));var d=h(".top_stories.showmore.open .media-feed-placeholder .media-feed-grid");d.length!==0&&d.append(r("video_and_audio/top_stories")),q(),w(),A()}function q(){var a=h(".media-feeds")[0];a.onclick=function(b){var c=b||window.event,d=c.target||c.srcElement;while(d!=a){if(d.nodeName=="ARTICLE"&&h(d).hasClass("media-feed-item")){m(c,d,s);break}if(d.nodeName=="H2"&&h("a",d).length!==0){m(c,d,u);break}if(h(d).hasClass("more-text")){m(c,d,x);break}d=d.parentNode}}}function r(a){var b='<div class="more-wrapper"><a class="more-text" href="#" data-cps-id="'+a+'" title="'+i.text.more+'">'+i.text.more+"</a></div>";return b}function s(a){if(h(a).hasClass("selected"))return!1;if(b.can("UseHistoryApi")&&a.attributes["data-uri"]!==null){var c=a.attributes["data-uri"].value,d="BBC News - "+a.attributes["data-headline"].value;return a.attributes["data-picture"]&&h("#media-asset-placeholder").attr("src",a.attributes["data-picture"].value),n(c,d),o(c,d),!1}}function t(a){return h('.media-feed[data-cps-id="'+a+'"]')}function u(b){var c=b.parentNode.attributes["data-cps-id"].value.replace("/news/",""),d=t(c),e=h(".media-feed-grid",d);d.toggleClass("open");var f=d.hasClass("open")?"open":"close",g=d.attr("data-event");a.pubsub.emit("map:index:toggle",[g,f]);if(e.length===0&&d.hasClass("open")){var i=h(".media-feed-error",d);i.length!==0&&i.remove(),d.addClass("loading-after"),a.pubsub.emit("map:feed:load",[c])}return!1}function v(b){var c=h(j.tabs[b].t).attr("data-cps-id");if(c){var d=t(c),e=h(".media-feed-grid",d);d.addClass("open"),e.length===0&&(d.addClass("loading-after"),a.pubsub.emit("map:feed:load",[c]))}}function w(){var a;h(".media-panel").each(function(b,c){h(b).hasClass("open")&&(a=c)}),j=new d(h("#media-tabs li"),h(".media-panel")),a&&(j.tabs[a].activate(),v(a))}function x(b){var c=h(b),d=t(c.attr("data-cps-id"));return d.toggleClass("showmore"),d.hasClass("showmore")?(a.pubsub.emit("map:index:topstories",["close"]),c.text(i.text.more)):(a.pubsub.emit("map:index:topstories",["open"]),c.text(i.text.less)),!1}function y(a,b){var c=t(a),d=h(".media-feed-placeholder",c);b&&d.html(b),timeStamp.insertTime();if(c.hasClass("showmore")){var e=h(".media-feed-grid",d);e.append(r(a))}c.removeClass("loading-after"),C()}function z(a,b){var c=t(a);c.removeClass("loading-after"),h(".media-feed-error",c).length===0&&c.append('<div class="media-feed-error">Media unavailable</div>')}function A(){var b=h(".media-feed.js-postload");b.each(function(b){var c=h(b).attr("data-cps-id");c!==null&&h(".media-feed-item",b).length===0&&(h(b).addClass("loading-after"),a.pubsub.emit("map:feed:load",[c]))})}function B(a,b){C(a),h(".related-video-audio .media-feed-grid").length==1?h(".related-video-audio .media-feed-grid").replaceWith(b.related):h(".related-video-audio .media-feed-error").length==1&&h(".related-video-audio .media-feed-error").replaceWith(b.related),h(".related-video-audio .media-feed-grid").length==1&&j.tabs[0].activate()}function C(a){a&&(l="/news/"+a);var b=h(".media-feed-item.selected");b.each(function(a){h(a).removeClass("selected"),h(".js-media-duration",h(a)).text(h(a).attr("data-duration"))});var c=h('.media-feed-item[data-uri="'+l+'"]');c.each(function(a){h(a).addClass("selected"),h(".js-media-duration",h(a)).text(i.text.nowplaying)})}var h=a.$,i={text:{more:"Show more",less:"Show less",nowplaying:"NOW PLAYING"}},j,k,l;return{init:p}}),define("module/mediaAssetPage/mediaAssetPage",["module/bootstrap","vendor/ender/reqwest","module/transclude","module/mediaAssetPage/assetView","module/mediaAssetPage/listView","module/mediaAssetPage/api","module/mediaAssetPage/map"],function(a,b,c,d,e,f,g){var h=new f;return{init:function(b,f){d.init(b),e.init(f),g.init(),mostWatchedTransclude=new c,mostWatchedTransclude.get(".media-tab.most-watched a",{target:".most-watched .media-feed-placeholder",success:function(){a.pubsub.emit("map:feed:request:success",["most-watched"])},insert:!0})}}}),define("module/story",["module/bootstrap","module/timestamp","module/imageenhancer","module/transclude","module/hyperpuff/hyperpuff","module/media/mediaHandler","module/media/mediaRegistry","config"],function(a,b,c,d,e,f,g,h){return{init:function(){var i=new b((new Date((new Date).toUTCString())).getTime()),j=new c(".story-body img"),k=new d;hyperpuff=new e(k);if(h.features.video){var l=new f(g,{audio:!1});l.createMedia()}if(a.$(".fetch-onward").length){var m=a.$("#page").attr("data-story-id");k.get(".fetch-onward",{maintainLink:!0,urlParameters:{flatten:!0,limit:3,exclude:m},target:"#story-onward-journey .placeholder-storyonward",success:function(){a.$(".placeholder-storyonward-status").removeClass("not-fetched").addClass("fetched"),i.insertTime(),new c}})}}}}),define("module/urlShrinker",["module/bootstrap","vendor/ender/reqwest"],function(a,b){return{init:function(){var b=a.$(".shortenUrl");for(var c=b.length-1;c>=0;c--)b[c].addEventListener("click",function(){var a=this,b=new XMLHttpRequest;targetUrl=a.getAttribute("data-target-url"),socialUrl=a.getAttribute("data-social-url"),shrinkerUrl="http://www.bbc.co.uk/modules/sharetools/v1/shrink.json?url=",b.open("GET",shrinkerUrl+encodeURIComponent(targetUrl),!1),b.send(),b.status===200&&(a.href=socialUrl+JSON.parse(b.responseText).url)},!1)}}}),define("module/base",["module/stats/statsSubscriber","module/stats/statsConfig","module/nav/navManager","module/urlShrinker","config"],function(a,b,c,d,e){return{init:function(e){c.init(),d.init(),new a(b)}}}),define("module/weather/weather",["module/bootstrap","vendor/ender/reqwest"],function(a,b){var c=function(b){this.options=b||{},this.options.type=this.options.type||"hourly",this.options.append_ext=this.options.append_ext||undefined,a.pubsub.addListener("locator:locationChanged",this.updateWeather,this)};return c.prototype.updateWeather=function(c){if(c&&c.id){a.pubsub.emit("weather:requestStarted");var d=a.config.pathPrefix+"/weather/"+c.id.toLowerCase()+"/"+this.options.type;b({url:d+(this.options.append_ext!==undefined?this.options.append_ext:""),method:"get",type:"html",success:function(b){a.pubsub.emit("weather:success",[b,c])},error:function(b){a.pubsub.emit("weather:requestError",[b])}})}},c}),define("module/weather/weatherView",["module/bootstrap"],function(a){var b=function(b){this.container=a.$(b);if(!this.container.length)return;this.weatherLinkHref=this.container.attr("href"),this.hideWeather(),a.pubsub.on("weather:success",this.handleSuccess,this),a.pubsub.on("weather:requestError",this.handleError,this)};return b.prototype={setContent:function(a,b){a=this.setLocationName(a,b.name),this.container.html(a)},setLink:function(a){a=a?a.toLowerCase():"",this.container.attr("href",this.weatherLinkHref+a)},setLocationName:function(a,b){return a.replace("{{locationName}}",b)},handleSuccess:function(a,b){this.setContent(a,b),this.setLink(b.id),this.showWeather()},handleError:function(){this.hideWeather()},showWeather:function(){this.container.removeClass("hidden")},hideWeather:function(){this.container.addClass("hidden")}},b});try{define("module/localnewsandweather",["module/bootstrap","locator/main","module/local/local","module/local/localView","module/weather/weather","module/weather/weatherView","config","translator"],function(a,b,c,d,e,f,g,h){var i={LOCATOR:".locator",WEATHER:".module-weather",LOCAL:".locator-stories-placeholder"},j={init:function(h){this.moduleElement=a.$(h);if(!this.moduleElement.length)return;this.moduleTitle=a.$(".local-weather-location"),this.locator=new b({pubsub:a.pubsub,enableReverseGeocode:g.local&&g.local.allowLocationLookup?g.local.allowLocationLookup:!1,enableAutoComplete:g.local&&g.local.allowAutoComplete?g.local.allowAutoComplete:!1,host:g.locatorHost}),this.local=new c({simple:g.local&&g.local.simple?g.local.simple:!1,story_limit:g.local&&g.local.story_limit?g.local.story_limit:2,append_ext:g.local&&g.local.append_ext?g.local.append_ext:undefined}),this.weather=new e({type:g.local&&g.local.weather_type?g.local.weather_type:"hourly",append_ext:g.local&&g.local.append_ext?g.local.append_ext:undefined}),this.localView=new d(i.LOCAL,this.moduleElement),this.weatherView=new f(i.WEATHER),this.renderLocator(),this.renderLocal(),this.renderWeather(),this.show()},setTitle:function(a,b){b&&(a='<a href="{{link}}" class="local-weather-location-action has-right-arrow"><span class="cta local-weather-location-label">{{title}}</span></a>'.replace("{{link}}",b).replace("{{title}}",a)),this.moduleTitle.html(a)},renderLocator:function(){this.locator.open(i.LOCATOR),this.location=this.locator.getLocation(),this.location||(this.setTitle(h.get("localNewsAndWeather")),a.pubsub.emit("locator:renderForm"))},renderLocal:function(){this.local.updateLocalNews(this.location)},renderWeather:function(){this.weather.updateWeather(this.location)},show:function(){this.moduleElement.removeClass("hidden")},hide:function(){this.moduleElement.addClass("hidden")}};return j})}catch(e){}define("module/index",["module/bootstrap","module/transclude","module/tabbed/tabbed","module/imageenhancer","module/timestamp","module/history/history","module/localnewsandweather","module/live-event-component","module/rollingNews","config"],function(a,b,c,d,e,f,g,h,i,j){return{init:function(){var g=new b,k=new e((new Date((new Date).toUTCString())).getTime()),l=a.$(".fetch").length;l?g.get(".fetch",{target:".panel-2 #most-popular-placeholder",complete:function(){var b=new c(a.$("#index-tabs li"),a.$("#index-panels .panel")),e=new f(["tabs:activate"],{eventName:"tabs:activate",data:[0]}),g=new d}}):imageEnhance=new d,j.features.localNews&&j.locatorFlagPole&&require(["locator/main","module/localnewsandweather"],function(a,b){b.init("#module-local-weather")}),j.features.liveEventComponent&&h.init(j.pollingHost,null),j.configuration.showRollingNews&&i.init()}}})